==========================================================
Data de início: Sun Nov 16 07:19:54 PM -03 2025
Nó de execução: dgx-H100-03
GPUs alocadas: 3
==========================================================
Rodando LAQDA (com BGE-M3) na Tarefa de Evasão (5-Fold)
--- Verificando/Rodando Fold 01 (k-shot = 55) ---
Rodando Fold 01...
Gerando dicionário de rótulos a partir de: data/QEvasionCorpus/few_shot/01/train.json
Dicionário de rótulos criado com sucesso: {'Claims ignorance': 0, 'Clarification': 1, 'Declining to answer': 2, 'Deflection': 3, 'Dodging': 4, 'Explicit': 5, 'General': 6, 'Implicit': 7, 'Partial/half-answer': 8}
Usando GPU: 0
Carregando encoder genérico: BAAI/bge-m3

Inicializando Dataloader de Treino...
Indexando data/QEvasionCorpus/few_shot/01/train.json...

Inicializando Dataloader de Validação...
Indexando data/QEvasionCorpus/few_shot/01/valid.json...

Inicializando Dataloader de Teste...
Indexando data/QEvasionCorpus/few_shot/01/test.json...
=== Época: 0 ===

Média Train Época 0: Loss: 0.7828, P: 0.7331, R: 0.7253, F1: 0.7224, Acc: 0.7253, AUC: 0.7903, TopKAcc: 0.5700

Média Val Época 0: Loss: 0.2882, P: 0.7610, R: 0.7537, F1: 0.7513, Acc: 0.7537 (Melhor), AUC: 0.8171, TopKAcc: 0.6018
Nova melhor acurácia de validação: 0.7537. Salvando modelo...
=== Época: 1 ===

Média Train Época 1: Loss: 0.2787, P: 0.7676, R: 0.7607, F1: 0.7587, Acc: 0.7607, AUC: 0.8180, TopKAcc: 0.5937

Média Val Época 1: Loss: 0.2677, P: 0.7787, R: 0.7703, F1: 0.7678, Acc: 0.7703 (Melhor), AUC: 0.8333, TopKAcc: 0.6150
Nova melhor acurácia de validação: 0.7703. Salvando modelo...
=== Época: 2 ===

Média Train Época 2: Loss: 0.2625, P: 0.7835, R: 0.7763, F1: 0.7741, Acc: 0.7763, AUC: 0.8397, TopKAcc: 0.6106

Média Val Época 2: Loss: 0.2552, P: 0.8118, R: 0.8030, F1: 0.8013, Acc: 0.8030 (Melhor), AUC: 0.8619, TopKAcc: 0.6305
Nova melhor acurácia de validação: 0.8030. Salvando modelo...
=== Época: 3 ===

Média Train Época 3: Loss: 0.2485, P: 0.8070, R: 0.7967, F1: 0.7946, Acc: 0.7967, AUC: 0.8641, TopKAcc: 0.6222

Média Val Época 3: Loss: 0.2420, P: 0.8234, R: 0.8153, F1: 0.8137, Acc: 0.8153 (Melhor), AUC: 0.8860, TopKAcc: 0.6311
Nova melhor acurácia de validação: 0.8153. Salvando modelo...
=== Época: 4 ===

Média Train Época 4: Loss: 0.2453, P: 0.7980, R: 0.7913, F1: 0.7891, Acc: 0.7913, AUC: 0.8562, TopKAcc: 0.6320

Média Val Época 4: Loss: 0.2315, P: 0.8309, R: 0.8250, F1: 0.8238, Acc: 0.8250 (Melhor), AUC: 0.8857, TopKAcc: 0.6561
Nova melhor acurácia de validação: 0.8250. Salvando modelo...
=== Época: 5 ===

Média Train Época 5: Loss: 0.2206, P: 0.8445, R: 0.8370, F1: 0.8357, Acc: 0.8370, AUC: 0.8961, TopKAcc: 0.6577

Média Val Época 5: Loss: 0.2269, P: 0.8245, R: 0.8190, F1: 0.8174, Acc: 0.8190 (Melhor: 0.8250), AUC: 0.8901, TopKAcc: 0.6512
=== Época: 6 ===

Média Train Época 6: Loss: 0.2195, P: 0.8277, R: 0.8223, F1: 0.8209, Acc: 0.8223, AUC: 0.8840, TopKAcc: 0.6486

Média Val Época 6: Loss: 0.2353, P: 0.8183, R: 0.8120, F1: 0.8107, Acc: 0.8120 (Melhor: 0.8250), AUC: 0.8809, TopKAcc: 0.6521
=== Época: 7 ===

Média Train Época 7: Loss: 0.2256, P: 0.8320, R: 0.8243, F1: 0.8229, Acc: 0.8243, AUC: 0.8857, TopKAcc: 0.6428

Média Val Época 7: Loss: 0.2160, P: 0.8345, R: 0.8277, F1: 0.8261, Acc: 0.8277 (Melhor), AUC: 0.8862, TopKAcc: 0.6587
Nova melhor acurácia de validação: 0.8277. Salvando modelo...
=== Época: 8 ===

Média Train Época 8: Loss: 0.2291, P: 0.8254, R: 0.8190, F1: 0.8177, Acc: 0.8190, AUC: 0.8764, TopKAcc: 0.6358

Média Val Época 8: Loss: 0.2089, P: 0.8602, R: 0.8530, F1: 0.8518, Acc: 0.8530 (Melhor), AUC: 0.9116, TopKAcc: 0.6558
Nova melhor acurácia de validação: 0.8530. Salvando modelo...
=== Época: 9 ===

Média Train Época 9: Loss: 0.2108, P: 0.8493, R: 0.8400, F1: 0.8375, Acc: 0.8400, AUC: 0.9044, TopKAcc: 0.6419

Média Val Época 9: Loss: 0.2163, P: 0.8444, R: 0.8387, F1: 0.8377, Acc: 0.8387 (Melhor: 0.8530), AUC: 0.9058, TopKAcc: 0.6432
=== Época: 10 ===

Média Train Época 10: Loss: 0.2057, P: 0.8453, R: 0.8383, F1: 0.8368, Acc: 0.8383, AUC: 0.9039, TopKAcc: 0.6576

Média Val Época 10: Loss: 0.2067, P: 0.8594, R: 0.8523, F1: 0.8511, Acc: 0.8523 (Melhor: 0.8530), AUC: 0.9086, TopKAcc: 0.6603
=== Época: 11 ===

Média Train Época 11: Loss: 0.1960, P: 0.8560, R: 0.8483, F1: 0.8465, Acc: 0.8483, AUC: 0.9092, TopKAcc: 0.6556

Média Val Época 11: Loss: 0.1967, P: 0.8682, R: 0.8603, F1: 0.8592, Acc: 0.8603 (Melhor), AUC: 0.9224, TopKAcc: 0.6653
Nova melhor acurácia de validação: 0.8603. Salvando modelo...
=== Época: 12 ===

Média Train Época 12: Loss: 0.1885, P: 0.8684, R: 0.8607, F1: 0.8592, Acc: 0.8607, AUC: 0.9213, TopKAcc: 0.6605

Média Val Época 12: Loss: 0.2092, P: 0.8448, R: 0.8400, F1: 0.8391, Acc: 0.8400 (Melhor: 0.8603), AUC: 0.9023, TopKAcc: 0.6528
=== Época: 13 ===

Média Train Época 13: Loss: 0.1723, P: 0.8917, R: 0.8860, F1: 0.8852, Acc: 0.8860, AUC: 0.9388, TopKAcc: 0.6725

Média Val Época 13: Loss: 0.1961, P: 0.8654, R: 0.8610, F1: 0.8603, Acc: 0.8610 (Melhor), AUC: 0.9228, TopKAcc: 0.6566
Nova melhor acurácia de validação: 0.8610. Salvando modelo...
=== Época: 14 ===

Média Train Época 14: Loss: 0.1765, P: 0.8847, R: 0.8807, F1: 0.8801, Acc: 0.8807, AUC: 0.9358, TopKAcc: 0.6779

Média Val Época 14: Loss: 0.2011, P: 0.8663, R: 0.8610, F1: 0.8598, Acc: 0.8610 (Melhor: 0.8610), AUC: 0.9136, TopKAcc: 0.6506
=== Época: 15 ===

Média Train Época 15: Loss: 0.1598, P: 0.9018, R: 0.8977, F1: 0.8970, Acc: 0.8977, AUC: 0.9507, TopKAcc: 0.6886

Média Val Época 15: Loss: 0.2002, P: 0.8619, R: 0.8530, F1: 0.8508, Acc: 0.8530 (Melhor: 0.8610), AUC: 0.9175, TopKAcc: 0.6417
=== Época: 16 ===

Média Train Época 16: Loss: 0.1706, P: 0.8907, R: 0.8840, F1: 0.8828, Acc: 0.8840, AUC: 0.9335, TopKAcc: 0.6749

Média Val Época 16: Loss: 0.1900, P: 0.8801, R: 0.8747, F1: 0.8738, Acc: 0.8747 (Melhor), AUC: 0.9293, TopKAcc: 0.6633
Nova melhor acurácia de validação: 0.8747. Salvando modelo...
=== Época: 17 ===

Média Train Época 17: Loss: 0.1638, P: 0.9138, R: 0.9080, F1: 0.9073, Acc: 0.9080, AUC: 0.9520, TopKAcc: 0.6816

Média Val Época 17: Loss: 0.1990, P: 0.8656, R: 0.8607, F1: 0.8596, Acc: 0.8607 (Melhor: 0.8747), AUC: 0.9236, TopKAcc: 0.6607
=== Época: 18 ===

Média Train Época 18: Loss: 0.1585, P: 0.9059, R: 0.9013, F1: 0.9007, Acc: 0.9013, AUC: 0.9537, TopKAcc: 0.6761

Média Val Época 18: Loss: 0.1851, P: 0.8813, R: 0.8773, F1: 0.8768, Acc: 0.8773 (Melhor), AUC: 0.9321, TopKAcc: 0.6589
Nova melhor acurácia de validação: 0.8773. Salvando modelo...
=== Época: 19 ===

Média Train Época 19: Loss: 0.1430, P: 0.9189, R: 0.9140, F1: 0.9131, Acc: 0.9140, AUC: 0.9613, TopKAcc: 0.6907

Média Val Época 19: Loss: 0.1846, P: 0.8843, R: 0.8797, F1: 0.8791, Acc: 0.8797 (Melhor), AUC: 0.9372, TopKAcc: 0.6546
Nova melhor acurácia de validação: 0.8797. Salvando modelo...
=== Época: 20 ===

Média Train Época 20: Loss: 0.1533, P: 0.9209, R: 0.9143, F1: 0.9132, Acc: 0.9143, AUC: 0.9683, TopKAcc: 0.6680

Média Val Época 20: Loss: 0.1806, P: 0.8895, R: 0.8840, F1: 0.8832, Acc: 0.8840 (Melhor), AUC: 0.9410, TopKAcc: 0.6543
Nova melhor acurácia de validação: 0.8840. Salvando modelo...
=== Época: 21 ===

Média Train Época 21: Loss: 0.1632, P: 0.9191, R: 0.9133, F1: 0.9124, Acc: 0.9133, AUC: 0.9552, TopKAcc: 0.6659

Média Val Época 21: Loss: 0.2019, P: 0.8684, R: 0.8617, F1: 0.8603, Acc: 0.8617 (Melhor: 0.8840), AUC: 0.9200, TopKAcc: 0.6322
=== Época: 22 ===

Média Train Época 22: Loss: 0.1444, P: 0.9319, R: 0.9273, F1: 0.9269, Acc: 0.9273, AUC: 0.9749, TopKAcc: 0.6673

Média Val Época 22: Loss: 0.2114, P: 0.8616, R: 0.8553, F1: 0.8544, Acc: 0.8553 (Melhor: 0.8840), AUC: 0.9208, TopKAcc: 0.6177
=== Época: 23 ===

Média Train Época 23: Loss: 0.1436, P: 0.9343, R: 0.9277, F1: 0.9270, Acc: 0.9277, AUC: 0.9761, TopKAcc: 0.6668

Média Val Época 23: Loss: 0.2011, P: 0.8728, R: 0.8663, F1: 0.8654, Acc: 0.8663 (Melhor: 0.8840), AUC: 0.9280, TopKAcc: 0.6339
=== Época: 24 ===

Média Train Época 24: Loss: 0.1585, P: 0.9185, R: 0.9113, F1: 0.9106, Acc: 0.9113, AUC: 0.9716, TopKAcc: 0.6545

Média Val Época 24: Loss: 0.2115, P: 0.8582, R: 0.8513, F1: 0.8504, Acc: 0.8513 (Melhor: 0.8840), AUC: 0.9225, TopKAcc: 0.6169
=== Época: 25 ===

Média Train Época 25: Loss: 0.1470, P: 0.9301, R: 0.9223, F1: 0.9214, Acc: 0.9223, AUC: 0.9783, TopKAcc: 0.6525

Média Val Época 25: Loss: 0.2009, P: 0.8735, R: 0.8673, F1: 0.8664, Acc: 0.8673 (Melhor: 0.8840), AUC: 0.9334, TopKAcc: 0.6202
=== Época: 26 ===

Média Train Época 26: Loss: 0.1462, P: 0.9279, R: 0.9223, F1: 0.9216, Acc: 0.9223, AUC: 0.9738, TopKAcc: 0.6695

Média Val Época 26: Loss: 0.2038, P: 0.8563, R: 0.8503, F1: 0.8493, Acc: 0.8503 (Melhor: 0.8840), AUC: 0.9170, TopKAcc: 0.6374
=== Época: 27 ===

Média Train Época 27: Loss: 0.1407, P: 0.9362, R: 0.9313, F1: 0.9309, Acc: 0.9313, AUC: 0.9782, TopKAcc: 0.6694

Média Val Época 27: Loss: 0.1877, P: 0.8838, R: 0.8740, F1: 0.8725, Acc: 0.8740 (Melhor: 0.8840), AUC: 0.9398, TopKAcc: 0.6366
=== Época: 28 ===

Média Train Época 28: Loss: 0.1520, P: 0.9206, R: 0.9153, F1: 0.9148, Acc: 0.9153, AUC: 0.9672, TopKAcc: 0.6472

Média Val Época 28: Loss: 0.1886, P: 0.8789, R: 0.8697, F1: 0.8684, Acc: 0.8697 (Melhor: 0.8840), AUC: 0.9388, TopKAcc: 0.6289
=== Época: 29 ===

Média Train Época 29: Loss: 0.1392, P: 0.9410, R: 0.9353, F1: 0.9349, Acc: 0.9353, AUC: 0.9867, TopKAcc: 0.6425

Média Val Época 29: Loss: 0.1961, P: 0.8797, R: 0.8720, F1: 0.8711, Acc: 0.8720 (Melhor: 0.8840), AUC: 0.9378, TopKAcc: 0.6250
=== Época: 30 ===

Média Train Época 30: Loss: 0.1398, P: 0.9387, R: 0.9323, F1: 0.9317, Acc: 0.9323, AUC: 0.9797, TopKAcc: 0.6448

Média Val Época 30: Loss: 0.2032, P: 0.8754, R: 0.8663, F1: 0.8651, Acc: 0.8663 (Melhor: 0.8840), AUC: 0.9364, TopKAcc: 0.6044
=== Época: 31 ===

Média Train Época 31: Loss: 0.1271, P: 0.9424, R: 0.9373, F1: 0.9370, Acc: 0.9373, AUC: 0.9826, TopKAcc: 0.6688

Média Val Época 31: Loss: 0.2051, P: 0.8651, R: 0.8533, F1: 0.8515, Acc: 0.8533 (Melhor: 0.8840), AUC: 0.9331, TopKAcc: 0.6040
=== Época: 32 ===

Média Train Época 32: Loss: 0.1424, P: 0.9439, R: 0.9373, F1: 0.9367, Acc: 0.9373, AUC: 0.9826, TopKAcc: 0.6472

Média Val Época 32: Loss: 0.1907, P: 0.8849, R: 0.8763, F1: 0.8752, Acc: 0.8763 (Melhor: 0.8840), AUC: 0.9422, TopKAcc: 0.6130
=== Época: 33 ===

Média Train Época 33: Loss: 0.1366, P: 0.9378, R: 0.9310, F1: 0.9304, Acc: 0.9310, AUC: 0.9856, TopKAcc: 0.6413

Média Val Época 33: Loss: 0.2098, P: 0.8677, R: 0.8590, F1: 0.8578, Acc: 0.8590 (Melhor: 0.8840), AUC: 0.9336, TopKAcc: 0.6080
=== Época: 34 ===

Média Train Época 34: Loss: 0.1177, P: 0.9472, R: 0.9420, F1: 0.9416, Acc: 0.9420, AUC: 0.9890, TopKAcc: 0.6762

Média Val Época 34: Loss: 0.1854, P: 0.8918, R: 0.8837, F1: 0.8827, Acc: 0.8837 (Melhor: 0.8840), AUC: 0.9465, TopKAcc: 0.6281
=== Época: 35 ===

Média Train Época 35: Loss: 0.1244, P: 0.9461, R: 0.9407, F1: 0.9402, Acc: 0.9407, AUC: 0.9883, TopKAcc: 0.6605

Média Val Época 35: Loss: 0.2152, P: 0.8672, R: 0.8580, F1: 0.8567, Acc: 0.8580 (Melhor: 0.8840), AUC: 0.9299, TopKAcc: 0.6175
=== Época: 36 ===

Média Train Época 36: Loss: 0.1170, P: 0.9565, R: 0.9523, F1: 0.9521, Acc: 0.9523, AUC: 0.9928, TopKAcc: 0.6693

Média Val Época 36: Loss: 0.1868, P: 0.8839, R: 0.8770, F1: 0.8759, Acc: 0.8770 (Melhor: 0.8840), AUC: 0.9374, TopKAcc: 0.6388
=== Época: 37 ===

Média Train Época 37: Loss: 0.1252, P: 0.9462, R: 0.9417, F1: 0.9413, Acc: 0.9417, AUC: 0.9870, TopKAcc: 0.6568

Média Val Época 37: Loss: 0.2017, P: 0.8780, R: 0.8710, F1: 0.8700, Acc: 0.8710 (Melhor: 0.8840), AUC: 0.9318, TopKAcc: 0.6156
=== Época: 38 ===

Média Train Época 38: Loss: 0.1205, P: 0.9434, R: 0.9367, F1: 0.9361, Acc: 0.9367, AUC: 0.9908, TopKAcc: 0.6603

Média Val Época 38: Loss: 0.1935, P: 0.8765, R: 0.8677, F1: 0.8663, Acc: 0.8677 (Melhor: 0.8840), AUC: 0.9351, TopKAcc: 0.6393
=== Época: 39 ===

Média Train Época 39: Loss: 0.1224, P: 0.9500, R: 0.9457, F1: 0.9454, Acc: 0.9457, AUC: 0.9892, TopKAcc: 0.6628

Média Val Época 39: Loss: 0.1964, P: 0.8730, R: 0.8620, F1: 0.8601, Acc: 0.8620 (Melhor: 0.8840), AUC: 0.9390, TopKAcc: 0.6232
=== Época: 40 ===

Média Train Época 40: Loss: 0.1089, P: 0.9605, R: 0.9553, F1: 0.9548, Acc: 0.9553, AUC: 0.9920, TopKAcc: 0.6778

Média Val Época 40: Loss: 0.2145, P: 0.8614, R: 0.8500, F1: 0.8483, Acc: 0.8500 (Melhor: 0.8840), AUC: 0.9275, TopKAcc: 0.5976
=== Época: 41 ===
Parando cedo na época 41.
Treinamento concluído.
Carregando o melhor estado do modelo (da validação) para teste.

Testando com o melhor modelo...

Resultados Finais do Teste
Test Loss: 0.2061
Test Acc: 0.8532
Test P (macro): 0.8639
Test R (macro): 0.8532
Test F1 (macro): 0.8516
Test AUC: 0.9342
Test TopKAcc: 0.6089
--- Verificando/Rodando Fold 02 (k-shot = 55) ---
Rodando Fold 02...
Gerando dicionário de rótulos a partir de: data/QEvasionCorpus/few_shot/02/train.json
Dicionário de rótulos criado com sucesso: {'Claims ignorance': 0, 'Clarification': 1, 'Declining to answer': 2, 'Deflection': 3, 'Dodging': 4, 'Explicit': 5, 'General': 6, 'Implicit': 7, 'Partial/half-answer': 8}
Usando GPU: 0
Carregando encoder genérico: BAAI/bge-m3

Inicializando Dataloader de Treino...
Indexando data/QEvasionCorpus/few_shot/02/train.json...

Inicializando Dataloader de Validação...
Indexando data/QEvasionCorpus/few_shot/02/valid.json...

Inicializando Dataloader de Teste...
Indexando data/QEvasionCorpus/few_shot/02/test.json...
=== Época: 0 ===

Média Train Época 0: Loss: 0.7468, P: 0.7545, R: 0.7470, F1: 0.7450, Acc: 0.7470, AUC: 0.8146, TopKAcc: 0.5802

Média Val Época 0: Loss: 0.2880, P: 0.7567, R: 0.7493, F1: 0.7470, Acc: 0.7493 (Melhor), AUC: 0.8207, TopKAcc: 0.5884
Nova melhor acurácia de validação: 0.7493. Salvando modelo...
=== Época: 1 ===

Média Train Época 1: Loss: 0.2867, P: 0.7677, R: 0.7583, F1: 0.7559, Acc: 0.7583, AUC: 0.8218, TopKAcc: 0.5819

Média Val Época 1: Loss: 0.2588, P: 0.7867, R: 0.7803, F1: 0.7790, Acc: 0.7803 (Melhor), AUC: 0.8423, TopKAcc: 0.6222
Nova melhor acurácia de validação: 0.7803. Salvando modelo...
=== Época: 2 ===

Média Train Época 2: Loss: 0.2499, P: 0.8098, R: 0.8037, F1: 0.8021, Acc: 0.8037, AUC: 0.8638, TopKAcc: 0.6177

Média Val Época 2: Loss: 0.2297, P: 0.8306, R: 0.8233, F1: 0.8217, Acc: 0.8233 (Melhor), AUC: 0.8745, TopKAcc: 0.6662
Nova melhor acurácia de validação: 0.8233. Salvando modelo...
=== Época: 3 ===

Média Train Época 3: Loss: 0.2340, P: 0.8274, R: 0.8200, F1: 0.8186, Acc: 0.8200, AUC: 0.8859, TopKAcc: 0.6354

Média Val Época 3: Loss: 0.2359, P: 0.8294, R: 0.8233, F1: 0.8221, Acc: 0.8233 (Melhor: 0.8233), AUC: 0.8766, TopKAcc: 0.6400
=== Época: 4 ===

Média Train Época 4: Loss: 0.2387, P: 0.8188, R: 0.8103, F1: 0.8084, Acc: 0.8103, AUC: 0.8690, TopKAcc: 0.6325

Média Val Época 4: Loss: 0.2379, P: 0.8176, R: 0.8110, F1: 0.8094, Acc: 0.8110 (Melhor: 0.8233), AUC: 0.8630, TopKAcc: 0.6461
=== Época: 5 ===

Média Train Época 5: Loss: 0.2182, P: 0.8464, R: 0.8387, F1: 0.8374, Acc: 0.8387, AUC: 0.9011, TopKAcc: 0.6500

Média Val Época 5: Loss: 0.2447, P: 0.8057, R: 0.7980, F1: 0.7955, Acc: 0.7977 (Melhor: 0.8233), AUC: 0.8642, TopKAcc: 0.6289
=== Época: 6 ===

Média Train Época 6: Loss: 0.2223, P: 0.8362, R: 0.8290, F1: 0.8277, Acc: 0.8290, AUC: 0.8947, TopKAcc: 0.6438

Média Val Época 6: Loss: 0.2045, P: 0.8625, R: 0.8567, F1: 0.8557, Acc: 0.8567 (Melhor), AUC: 0.9128, TopKAcc: 0.6721
Nova melhor acurácia de validação: 0.8567. Salvando modelo...
=== Época: 7 ===

Média Train Época 7: Loss: 0.2187, P: 0.8381, R: 0.8323, F1: 0.8311, Acc: 0.8323, AUC: 0.8898, TopKAcc: 0.6414

Média Val Época 7: Loss: 0.2217, P: 0.8290, R: 0.8217, F1: 0.8200, Acc: 0.8217 (Melhor: 0.8567), AUC: 0.8880, TopKAcc: 0.6619
=== Época: 8 ===

Média Train Época 8: Loss: 0.2183, P: 0.8302, R: 0.8253, F1: 0.8228, Acc: 0.8253, AUC: 0.8849, TopKAcc: 0.6448

Média Val Época 8: Loss: 0.2024, P: 0.8565, R: 0.8510, F1: 0.8498, Acc: 0.8510 (Melhor: 0.8567), AUC: 0.9043, TopKAcc: 0.6667
=== Época: 9 ===

Média Train Época 9: Loss: 0.2049, P: 0.8496, R: 0.8450, F1: 0.8439, Acc: 0.8450, AUC: 0.8960, TopKAcc: 0.6538

Média Val Época 9: Loss: 0.1962, P: 0.8650, R: 0.8573, F1: 0.8558, Acc: 0.8573 (Melhor), AUC: 0.9240, TopKAcc: 0.6641
Nova melhor acurácia de validação: 0.8573. Salvando modelo...
=== Época: 10 ===

Média Train Época 10: Loss: 0.1976, P: 0.8650, R: 0.8583, F1: 0.8560, Acc: 0.8583, AUC: 0.9149, TopKAcc: 0.6496

Média Val Época 10: Loss: 0.2172, P: 0.8528, R: 0.8470, F1: 0.8459, Acc: 0.8470 (Melhor: 0.8573), AUC: 0.9044, TopKAcc: 0.6364
=== Época: 11 ===

Média Train Época 11: Loss: 0.2032, P: 0.8574, R: 0.8513, F1: 0.8502, Acc: 0.8513, AUC: 0.9166, TopKAcc: 0.6366

Média Val Época 11: Loss: 0.2338, P: 0.8369, R: 0.8293, F1: 0.8275, Acc: 0.8293 (Melhor: 0.8573), AUC: 0.8844, TopKAcc: 0.6365
=== Época: 12 ===

Média Train Época 12: Loss: 0.1950, P: 0.8659, R: 0.8587, F1: 0.8571, Acc: 0.8587, AUC: 0.9203, TopKAcc: 0.6451

Média Val Época 12: Loss: 0.2076, P: 0.8610, R: 0.8553, F1: 0.8544, Acc: 0.8553 (Melhor: 0.8573), AUC: 0.9117, TopKAcc: 0.6503
=== Época: 13 ===

Média Train Época 13: Loss: 0.1707, P: 0.8979, R: 0.8913, F1: 0.8900, Acc: 0.8913, AUC: 0.9523, TopKAcc: 0.6605

Média Val Época 13: Loss: 0.1935, P: 0.8707, R: 0.8627, F1: 0.8610, Acc: 0.8627 (Melhor), AUC: 0.9281, TopKAcc: 0.6619
Nova melhor acurácia de validação: 0.8627. Salvando modelo...
=== Época: 14 ===

Média Train Época 14: Loss: 0.1721, P: 0.8929, R: 0.8873, F1: 0.8860, Acc: 0.8873, AUC: 0.9415, TopKAcc: 0.6640

Média Val Época 14: Loss: 0.2009, P: 0.8562, R: 0.8510, F1: 0.8501, Acc: 0.8510 (Melhor: 0.8627), AUC: 0.9164, TopKAcc: 0.6483
=== Época: 15 ===

Média Train Época 15: Loss: 0.1826, P: 0.8805, R: 0.8750, F1: 0.8731, Acc: 0.8750, AUC: 0.9348, TopKAcc: 0.6565

Média Val Época 15: Loss: 0.1819, P: 0.8786, R: 0.8733, F1: 0.8720, Acc: 0.8733 (Melhor), AUC: 0.9332, TopKAcc: 0.6763
Nova melhor acurácia de validação: 0.8733. Salvando modelo...
=== Época: 16 ===

Média Train Época 16: Loss: 0.1555, P: 0.9139, R: 0.9087, F1: 0.9079, Acc: 0.9087, AUC: 0.9606, TopKAcc: 0.6729

Média Val Época 16: Loss: 0.2038, P: 0.8583, R: 0.8533, F1: 0.8518, Acc: 0.8533 (Melhor: 0.8733), AUC: 0.9181, TopKAcc: 0.6412
=== Época: 17 ===

Média Train Época 17: Loss: 0.1691, P: 0.8906, R: 0.8857, F1: 0.8841, Acc: 0.8857, AUC: 0.9382, TopKAcc: 0.6595

Média Val Época 17: Loss: 0.1950, P: 0.8698, R: 0.8643, F1: 0.8634, Acc: 0.8643 (Melhor: 0.8733), AUC: 0.9267, TopKAcc: 0.6399
=== Época: 18 ===

Média Train Época 18: Loss: 0.1571, P: 0.9128, R: 0.9073, F1: 0.9062, Acc: 0.9073, AUC: 0.9593, TopKAcc: 0.6613

Média Val Época 18: Loss: 0.2044, P: 0.8773, R: 0.8717, F1: 0.8708, Acc: 0.8717 (Melhor: 0.8733), AUC: 0.9300, TopKAcc: 0.6541
=== Época: 19 ===

Média Train Época 19: Loss: 0.1534, P: 0.9152, R: 0.9100, F1: 0.9091, Acc: 0.9100, AUC: 0.9618, TopKAcc: 0.6691

Média Val Época 19: Loss: 0.1889, P: 0.8766, R: 0.8697, F1: 0.8682, Acc: 0.8697 (Melhor: 0.8733), AUC: 0.9389, TopKAcc: 0.6402
=== Época: 20 ===

Média Train Época 20: Loss: 0.1579, P: 0.9065, R: 0.8983, F1: 0.8968, Acc: 0.8983, AUC: 0.9548, TopKAcc: 0.6659

Média Val Época 20: Loss: 0.1961, P: 0.8747, R: 0.8700, F1: 0.8688, Acc: 0.8700 (Melhor: 0.8733), AUC: 0.9209, TopKAcc: 0.6401
=== Época: 21 ===

Média Train Época 21: Loss: 0.1586, P: 0.9153, R: 0.9093, F1: 0.9087, Acc: 0.9093, AUC: 0.9664, TopKAcc: 0.6583

Média Val Época 21: Loss: 0.1936, P: 0.8684, R: 0.8623, F1: 0.8609, Acc: 0.8623 (Melhor: 0.8733), AUC: 0.9283, TopKAcc: 0.6640
=== Época: 22 ===

Média Train Época 22: Loss: 0.1342, P: 0.9330, R: 0.9280, F1: 0.9274, Acc: 0.9280, AUC: 0.9764, TopKAcc: 0.6953

Média Val Época 22: Loss: 0.2033, P: 0.8814, R: 0.8737, F1: 0.8726, Acc: 0.8737 (Melhor), AUC: 0.9420, TopKAcc: 0.6739
Nova melhor acurácia de validação: 0.8737. Salvando modelo...
=== Época: 23 ===

Média Train Época 23: Loss: 0.1423, P: 0.9235, R: 0.9190, F1: 0.9182, Acc: 0.9190, AUC: 0.9667, TopKAcc: 0.6750

Média Val Época 23: Loss: 0.1845, P: 0.8815, R: 0.8757, F1: 0.8748, Acc: 0.8757 (Melhor), AUC: 0.9335, TopKAcc: 0.6631
Nova melhor acurácia de validação: 0.8757. Salvando modelo...
=== Época: 24 ===

Média Train Época 24: Loss: 0.1402, P: 0.9288, R: 0.9237, F1: 0.9229, Acc: 0.9237, AUC: 0.9692, TopKAcc: 0.6663

Média Val Época 24: Loss: 0.1796, P: 0.8861, R: 0.8803, F1: 0.8793, Acc: 0.8803 (Melhor), AUC: 0.9462, TopKAcc: 0.6560
Nova melhor acurácia de validação: 0.8803. Salvando modelo...
=== Época: 25 ===

Média Train Época 25: Loss: 0.1323, P: 0.9384, R: 0.9343, F1: 0.9341, Acc: 0.9343, AUC: 0.9789, TopKAcc: 0.6758

Média Val Época 25: Loss: 0.1782, P: 0.8956, R: 0.8883, F1: 0.8874, Acc: 0.8883 (Melhor), AUC: 0.9511, TopKAcc: 0.6420
Nova melhor acurácia de validação: 0.8883. Salvando modelo...
=== Época: 26 ===

Média Train Época 26: Loss: 0.1303, P: 0.9442, R: 0.9407, F1: 0.9404, Acc: 0.9407, AUC: 0.9803, TopKAcc: 0.6709

Média Val Época 26: Loss: 0.1757, P: 0.9001, R: 0.8937, F1: 0.8928, Acc: 0.8937 (Melhor), AUC: 0.9534, TopKAcc: 0.6332
Nova melhor acurácia de validação: 0.8937. Salvando modelo...
=== Época: 27 ===

Média Train Época 27: Loss: 0.1413, P: 0.9352, R: 0.9310, F1: 0.9306, Acc: 0.9310, AUC: 0.9759, TopKAcc: 0.6559

Média Val Época 27: Loss: 0.1912, P: 0.8839, R: 0.8763, F1: 0.8754, Acc: 0.8763 (Melhor: 0.8937), AUC: 0.9424, TopKAcc: 0.6223
=== Época: 28 ===

Média Train Época 28: Loss: 0.1412, P: 0.9391, R: 0.9340, F1: 0.9335, Acc: 0.9340, AUC: 0.9781, TopKAcc: 0.6577

Média Val Época 28: Loss: 0.1932, P: 0.8890, R: 0.8843, F1: 0.8837, Acc: 0.8843 (Melhor: 0.8937), AUC: 0.9441, TopKAcc: 0.6240
=== Época: 29 ===

Média Train Época 29: Loss: 0.1328, P: 0.9435, R: 0.9390, F1: 0.9386, Acc: 0.9390, AUC: 0.9821, TopKAcc: 0.6618

Média Val Época 29: Loss: 0.1826, P: 0.8933, R: 0.8877, F1: 0.8869, Acc: 0.8877 (Melhor: 0.8937), AUC: 0.9500, TopKAcc: 0.6315
=== Época: 30 ===

Média Train Época 30: Loss: 0.1181, P: 0.9539, R: 0.9507, F1: 0.9503, Acc: 0.9507, AUC: 0.9882, TopKAcc: 0.6770

Média Val Época 30: Loss: 0.1882, P: 0.8866, R: 0.8803, F1: 0.8796, Acc: 0.8803 (Melhor: 0.8937), AUC: 0.9528, TopKAcc: 0.6160
=== Época: 31 ===

Média Train Época 31: Loss: 0.1387, P: 0.9385, R: 0.9333, F1: 0.9328, Acc: 0.9333, AUC: 0.9811, TopKAcc: 0.6472

Média Val Época 31: Loss: 0.2076, P: 0.8716, R: 0.8610, F1: 0.8593, Acc: 0.8610 (Melhor: 0.8937), AUC: 0.9366, TopKAcc: 0.6180
=== Época: 32 ===

Média Train Época 32: Loss: 0.1330, P: 0.9484, R: 0.9437, F1: 0.9434, Acc: 0.9437, AUC: 0.9887, TopKAcc: 0.6463

Média Val Época 32: Loss: 0.1760, P: 0.8983, R: 0.8903, F1: 0.8894, Acc: 0.8903 (Melhor: 0.8937), AUC: 0.9628, TopKAcc: 0.6174
=== Época: 33 ===

Média Train Época 33: Loss: 0.1369, P: 0.9396, R: 0.9343, F1: 0.9338, Acc: 0.9343, AUC: 0.9830, TopKAcc: 0.6424

Média Val Época 33: Loss: 0.2055, P: 0.8601, R: 0.8523, F1: 0.8512, Acc: 0.8523 (Melhor: 0.8937), AUC: 0.9391, TopKAcc: 0.6122
=== Época: 34 ===

Média Train Época 34: Loss: 0.1429, P: 0.9368, R: 0.9313, F1: 0.9310, Acc: 0.9313, AUC: 0.9845, TopKAcc: 0.6292

Média Val Época 34: Loss: 0.1961, P: 0.8781, R: 0.8687, F1: 0.8672, Acc: 0.8687 (Melhor: 0.8937), AUC: 0.9380, TopKAcc: 0.6023
=== Época: 35 ===

Média Train Época 35: Loss: 0.1302, P: 0.9477, R: 0.9433, F1: 0.9430, Acc: 0.9433, AUC: 0.9872, TopKAcc: 0.6447

Média Val Época 35: Loss: 0.1892, P: 0.8923, R: 0.8857, F1: 0.8848, Acc: 0.8857 (Melhor: 0.8937), AUC: 0.9508, TopKAcc: 0.6175
=== Época: 36 ===

Média Train Época 36: Loss: 0.1334, P: 0.9414, R: 0.9370, F1: 0.9367, Acc: 0.9370, AUC: 0.9846, TopKAcc: 0.6318

Média Val Época 36: Loss: 0.1828, P: 0.8960, R: 0.8890, F1: 0.8884, Acc: 0.8890 (Melhor: 0.8937), AUC: 0.9564, TopKAcc: 0.6095
=== Época: 37 ===

Média Train Época 37: Loss: 0.1204, P: 0.9551, R: 0.9520, F1: 0.9517, Acc: 0.9520, AUC: 0.9876, TopKAcc: 0.6582

Média Val Época 37: Loss: 0.1966, P: 0.8829, R: 0.8757, F1: 0.8749, Acc: 0.8757 (Melhor: 0.8937), AUC: 0.9441, TopKAcc: 0.6032
=== Época: 38 ===

Média Train Época 38: Loss: 0.1268, P: 0.9575, R: 0.9533, F1: 0.9531, Acc: 0.9533, AUC: 0.9915, TopKAcc: 0.6372

Média Val Época 38: Loss: 0.1906, P: 0.8861, R: 0.8783, F1: 0.8773, Acc: 0.8783 (Melhor: 0.8937), AUC: 0.9522, TopKAcc: 0.5971
=== Época: 39 ===

Média Train Época 39: Loss: 0.1199, P: 0.9567, R: 0.9513, F1: 0.9509, Acc: 0.9513, AUC: 0.9946, TopKAcc: 0.6456

Média Val Época 39: Loss: 0.1815, P: 0.8937, R: 0.8877, F1: 0.8869, Acc: 0.8877 (Melhor: 0.8937), AUC: 0.9540, TopKAcc: 0.6136
=== Época: 40 ===

Média Train Época 40: Loss: 0.1264, P: 0.9494, R: 0.9443, F1: 0.9439, Acc: 0.9443, AUC: 0.9892, TopKAcc: 0.6462

Média Val Época 40: Loss: 0.1974, P: 0.8812, R: 0.8730, F1: 0.8720, Acc: 0.8730 (Melhor: 0.8937), AUC: 0.9444, TopKAcc: 0.5934
=== Época: 41 ===

Média Train Época 41: Loss: 0.1334, P: 0.9458, R: 0.9387, F1: 0.9381, Acc: 0.9387, AUC: 0.9921, TopKAcc: 0.6219

Média Val Época 41: Loss: 0.2163, P: 0.8631, R: 0.8537, F1: 0.8525, Acc: 0.8537 (Melhor: 0.8937), AUC: 0.9379, TopKAcc: 0.5879
=== Época: 42 ===

Média Train Época 42: Loss: 0.1235, P: 0.9519, R: 0.9467, F1: 0.9463, Acc: 0.9467, AUC: 0.9915, TopKAcc: 0.6583

Média Val Época 42: Loss: 0.2064, P: 0.8724, R: 0.8650, F1: 0.8641, Acc: 0.8650 (Melhor: 0.8937), AUC: 0.9414, TopKAcc: 0.5914
=== Época: 43 ===

Média Train Época 43: Loss: 0.1141, P: 0.9560, R: 0.9513, F1: 0.9511, Acc: 0.9513, AUC: 0.9955, TopKAcc: 0.6520

Média Val Época 43: Loss: 0.1923, P: 0.8970, R: 0.8903, F1: 0.8896, Acc: 0.8903 (Melhor: 0.8937), AUC: 0.9494, TopKAcc: 0.6222
=== Época: 44 ===

Média Train Época 44: Loss: 0.1211, P: 0.9514, R: 0.9467, F1: 0.9464, Acc: 0.9467, AUC: 0.9917, TopKAcc: 0.6549

Média Val Época 44: Loss: 0.1851, P: 0.8973, R: 0.8900, F1: 0.8891, Acc: 0.8900 (Melhor: 0.8937), AUC: 0.9529, TopKAcc: 0.6439
=== Época: 45 ===

Média Train Época 45: Loss: 0.1216, P: 0.9520, R: 0.9477, F1: 0.9474, Acc: 0.9477, AUC: 0.9920, TopKAcc: 0.6387

Média Val Época 45: Loss: 0.1840, P: 0.8994, R: 0.8923, F1: 0.8916, Acc: 0.8923 (Melhor: 0.8937), AUC: 0.9536, TopKAcc: 0.6089
=== Época: 46 ===

Média Train Época 46: Loss: 0.1284, P: 0.9495, R: 0.9440, F1: 0.9437, Acc: 0.9440, AUC: 0.9946, TopKAcc: 0.6270

Média Val Época 46: Loss: 0.1898, P: 0.8974, R: 0.8893, F1: 0.8880, Acc: 0.8893 (Melhor: 0.8937), AUC: 0.9518, TopKAcc: 0.6310
=== Época: 47 ===
Parando cedo na época 47.
Treinamento concluído.
Carregando o melhor estado do modelo (da validação) para teste.

Testando com o melhor modelo...

Resultados Finais do Teste
Test Loss: 0.1971
Test Acc: 0.8768
Test P (macro): 0.8852
Test R (macro): 0.8768
Test F1 (macro): 0.8756
Test AUC: 0.9455
Test TopKAcc: 0.6210
--- Verificando/Rodando Fold 03 (k-shot = 55) ---
Rodando Fold 03...
Gerando dicionário de rótulos a partir de: data/QEvasionCorpus/few_shot/03/train.json
Dicionário de rótulos criado com sucesso: {'Claims ignorance': 0, 'Clarification': 1, 'Declining to answer': 2, 'Deflection': 3, 'Dodging': 4, 'Explicit': 5, 'General': 6, 'Implicit': 7, 'Partial/half-answer': 8}
Usando GPU: 0
Carregando encoder genérico: BAAI/bge-m3

Inicializando Dataloader de Treino...
Indexando data/QEvasionCorpus/few_shot/03/train.json...

Inicializando Dataloader de Validação...
Indexando data/QEvasionCorpus/few_shot/03/valid.json...

Inicializando Dataloader de Teste...
Indexando data/QEvasionCorpus/few_shot/03/test.json...
=== Época: 0 ===

Média Train Época 0: Loss: 0.7643, P: 0.7324, R: 0.7230, F1: 0.7188, Acc: 0.7230, AUC: 0.7990, TopKAcc: 0.5734

Média Val Época 0: Loss: 0.2745, P: 0.7724, R: 0.7660, F1: 0.7640, Acc: 0.7660 (Melhor), AUC: 0.8193, TopKAcc: 0.5994
Nova melhor acurácia de validação: 0.7660. Salvando modelo...
=== Época: 1 ===

Média Train Época 1: Loss: 0.2864, P: 0.7558, R: 0.7487, F1: 0.7456, Acc: 0.7487, AUC: 0.8205, TopKAcc: 0.5822

Média Val Época 1: Loss: 0.2701, P: 0.7784, R: 0.7703, F1: 0.7678, Acc: 0.7703 (Melhor), AUC: 0.8325, TopKAcc: 0.6104
Nova melhor acurácia de validação: 0.7703. Salvando modelo...
=== Época: 2 ===

Média Train Época 2: Loss: 0.2627, P: 0.7913, R: 0.7840, F1: 0.7823, Acc: 0.7840, AUC: 0.8480, TopKAcc: 0.6070

Média Val Época 2: Loss: 0.2547, P: 0.8001, R: 0.7923, F1: 0.7900, Acc: 0.7923 (Melhor), AUC: 0.8620, TopKAcc: 0.6217
Nova melhor acurácia de validação: 0.7923. Salvando modelo...
=== Época: 3 ===

Média Train Época 3: Loss: 0.2468, P: 0.8228, R: 0.8153, F1: 0.8138, Acc: 0.8153, AUC: 0.8792, TopKAcc: 0.6191

Média Val Época 3: Loss: 0.2263, P: 0.8259, R: 0.8177, F1: 0.8157, Acc: 0.8177 (Melhor), AUC: 0.8764, TopKAcc: 0.6523
Nova melhor acurácia de validação: 0.8177. Salvando modelo...
=== Época: 4 ===

Média Train Época 4: Loss: 0.2253, P: 0.8374, R: 0.8313, F1: 0.8304, Acc: 0.8313, AUC: 0.8883, TopKAcc: 0.6427

Média Val Época 4: Loss: 0.2325, P: 0.8171, R: 0.8097, F1: 0.8073, Acc: 0.8097 (Melhor: 0.8177), AUC: 0.8721, TopKAcc: 0.6481
=== Época: 5 ===

Média Train Época 5: Loss: 0.2326, P: 0.8262, R: 0.8187, F1: 0.8169, Acc: 0.8187, AUC: 0.8780, TopKAcc: 0.6320

Média Val Época 5: Loss: 0.2187, P: 0.8304, R: 0.8250, F1: 0.8239, Acc: 0.8250 (Melhor), AUC: 0.8801, TopKAcc: 0.6553
Nova melhor acurácia de validação: 0.8250. Salvando modelo...
=== Época: 6 ===

Média Train Época 6: Loss: 0.2206, P: 0.8464, R: 0.8400, F1: 0.8385, Acc: 0.8400, AUC: 0.8936, TopKAcc: 0.6474

Média Val Época 6: Loss: 0.2277, P: 0.8187, R: 0.8140, F1: 0.8129, Acc: 0.8140 (Melhor: 0.8250), AUC: 0.8674, TopKAcc: 0.6545
=== Época: 7 ===

Média Train Época 7: Loss: 0.2030, P: 0.8477, R: 0.8430, F1: 0.8419, Acc: 0.8430, AUC: 0.9016, TopKAcc: 0.6612

Média Val Época 7: Loss: 0.2170, P: 0.8268, R: 0.8227, F1: 0.8216, Acc: 0.8227 (Melhor: 0.8250), AUC: 0.8851, TopKAcc: 0.6650
=== Época: 8 ===

Média Train Época 8: Loss: 0.2029, P: 0.8604, R: 0.8517, F1: 0.8496, Acc: 0.8517, AUC: 0.9162, TopKAcc: 0.6634

Média Val Época 8: Loss: 0.2262, P: 0.8161, R: 0.8107, F1: 0.8089, Acc: 0.8107 (Melhor: 0.8250), AUC: 0.8774, TopKAcc: 0.6582
=== Época: 9 ===

Média Train Época 9: Loss: 0.2161, P: 0.8495, R: 0.8410, F1: 0.8393, Acc: 0.8410, AUC: 0.9045, TopKAcc: 0.6412

Média Val Época 9: Loss: 0.2078, P: 0.8346, R: 0.8307, F1: 0.8287, Acc: 0.8307 (Melhor), AUC: 0.8956, TopKAcc: 0.6742
Nova melhor acurácia de validação: 0.8307. Salvando modelo...
=== Época: 10 ===

Média Train Época 10: Loss: 0.2029, P: 0.8599, R: 0.8523, F1: 0.8507, Acc: 0.8523, AUC: 0.9117, TopKAcc: 0.6577

Média Val Época 10: Loss: 0.1928, P: 0.8568, R: 0.8513, F1: 0.8501, Acc: 0.8513 (Melhor), AUC: 0.9099, TopKAcc: 0.6835
Nova melhor acurácia de validação: 0.8513. Salvando modelo...
=== Época: 11 ===

Média Train Época 11: Loss: 0.1969, P: 0.8582, R: 0.8523, F1: 0.8508, Acc: 0.8523, AUC: 0.9105, TopKAcc: 0.6614

Média Val Época 11: Loss: 0.2195, P: 0.8381, R: 0.8327, F1: 0.8315, Acc: 0.8327 (Melhor: 0.8513), AUC: 0.8961, TopKAcc: 0.6446
=== Época: 12 ===

Média Train Época 12: Loss: 0.1777, P: 0.8795, R: 0.8727, F1: 0.8711, Acc: 0.8727, AUC: 0.9298, TopKAcc: 0.6775

Média Val Época 12: Loss: 0.2211, P: 0.8298, R: 0.8233, F1: 0.8215, Acc: 0.8233 (Melhor: 0.8513), AUC: 0.8868, TopKAcc: 0.6476
=== Época: 13 ===

Média Train Época 13: Loss: 0.1788, P: 0.8833, R: 0.8777, F1: 0.8763, Acc: 0.8777, AUC: 0.9384, TopKAcc: 0.6667

Média Val Época 13: Loss: 0.1681, P: 0.8927, R: 0.8860, F1: 0.8849, Acc: 0.8860 (Melhor), AUC: 0.9426, TopKAcc: 0.6873
Nova melhor acurácia de validação: 0.8860. Salvando modelo...
=== Época: 14 ===

Média Train Época 14: Loss: 0.1677, P: 0.8945, R: 0.8880, F1: 0.8867, Acc: 0.8880, AUC: 0.9355, TopKAcc: 0.6782

Média Val Época 14: Loss: 0.1989, P: 0.8620, R: 0.8577, F1: 0.8565, Acc: 0.8577 (Melhor: 0.8860), AUC: 0.9109, TopKAcc: 0.6715
=== Época: 15 ===

Média Train Época 15: Loss: 0.1797, P: 0.8808, R: 0.8757, F1: 0.8744, Acc: 0.8757, AUC: 0.9350, TopKAcc: 0.6593

Média Val Época 15: Loss: 0.2081, P: 0.8471, R: 0.8407, F1: 0.8394, Acc: 0.8407 (Melhor: 0.8860), AUC: 0.9095, TopKAcc: 0.6534
=== Época: 16 ===

Média Train Época 16: Loss: 0.1559, P: 0.9136, R: 0.9080, F1: 0.9068, Acc: 0.9080, AUC: 0.9591, TopKAcc: 0.6736

Média Val Época 16: Loss: 0.2123, P: 0.8534, R: 0.8473, F1: 0.8461, Acc: 0.8473 (Melhor: 0.8860), AUC: 0.9074, TopKAcc: 0.6471
=== Época: 17 ===

Média Train Época 17: Loss: 0.1585, P: 0.9130, R: 0.9073, F1: 0.9066, Acc: 0.9073, AUC: 0.9617, TopKAcc: 0.6625

Média Val Época 17: Loss: 0.1893, P: 0.8833, R: 0.8787, F1: 0.8780, Acc: 0.8787 (Melhor: 0.8860), AUC: 0.9345, TopKAcc: 0.6480
=== Época: 18 ===

Média Train Época 18: Loss: 0.1693, P: 0.9013, R: 0.8963, F1: 0.8957, Acc: 0.8963, AUC: 0.9474, TopKAcc: 0.6603

Média Val Época 18: Loss: 0.1988, P: 0.8636, R: 0.8590, F1: 0.8580, Acc: 0.8590 (Melhor: 0.8860), AUC: 0.9196, TopKAcc: 0.6468
=== Época: 19 ===

Média Train Época 19: Loss: 0.1576, P: 0.9119, R: 0.9047, F1: 0.9033, Acc: 0.9047, AUC: 0.9552, TopKAcc: 0.6713

Média Val Época 19: Loss: 0.2140, P: 0.8550, R: 0.8507, F1: 0.8498, Acc: 0.8507 (Melhor: 0.8860), AUC: 0.9108, TopKAcc: 0.6274
=== Época: 20 ===

Média Train Época 20: Loss: 0.1560, P: 0.9225, R: 0.9170, F1: 0.9164, Acc: 0.9170, AUC: 0.9672, TopKAcc: 0.6501

Média Val Época 20: Loss: 0.2127, P: 0.8540, R: 0.8453, F1: 0.8433, Acc: 0.8453 (Melhor: 0.8860), AUC: 0.9194, TopKAcc: 0.6388
=== Época: 21 ===

Média Train Época 21: Loss: 0.1635, P: 0.9136, R: 0.9067, F1: 0.9056, Acc: 0.9067, AUC: 0.9602, TopKAcc: 0.6498

Média Val Época 21: Loss: 0.2038, P: 0.8799, R: 0.8710, F1: 0.8696, Acc: 0.8710 (Melhor: 0.8860), AUC: 0.9351, TopKAcc: 0.6324
=== Época: 22 ===

Média Train Época 22: Loss: 0.1674, P: 0.9148, R: 0.9080, F1: 0.9072, Acc: 0.9080, AUC: 0.9653, TopKAcc: 0.6398

Média Val Época 22: Loss: 0.2306, P: 0.8469, R: 0.8383, F1: 0.8369, Acc: 0.8383 (Melhor: 0.8860), AUC: 0.9068, TopKAcc: 0.6043
=== Época: 23 ===

Média Train Época 23: Loss: 0.1544, P: 0.9302, R: 0.9260, F1: 0.9257, Acc: 0.9260, AUC: 0.9737, TopKAcc: 0.6441

Média Val Época 23: Loss: 0.2175, P: 0.8649, R: 0.8573, F1: 0.8559, Acc: 0.8573 (Melhor: 0.8860), AUC: 0.9268, TopKAcc: 0.6036
=== Época: 24 ===

Média Train Época 24: Loss: 0.1493, P: 0.9346, R: 0.9290, F1: 0.9286, Acc: 0.9290, AUC: 0.9796, TopKAcc: 0.6462

Média Val Época 24: Loss: 0.2113, P: 0.8711, R: 0.8643, F1: 0.8631, Acc: 0.8643 (Melhor: 0.8860), AUC: 0.9308, TopKAcc: 0.6177
=== Época: 25 ===

Média Train Época 25: Loss: 0.1599, P: 0.9271, R: 0.9203, F1: 0.9196, Acc: 0.9203, AUC: 0.9768, TopKAcc: 0.6324

Média Val Época 25: Loss: 0.2254, P: 0.8537, R: 0.8463, F1: 0.8450, Acc: 0.8463 (Melhor: 0.8860), AUC: 0.9141, TopKAcc: 0.5974
=== Época: 26 ===

Média Train Época 26: Loss: 0.1390, P: 0.9368, R: 0.9303, F1: 0.9295, Acc: 0.9303, AUC: 0.9788, TopKAcc: 0.6566

Média Val Época 26: Loss: 0.2204, P: 0.8479, R: 0.8427, F1: 0.8416, Acc: 0.8427 (Melhor: 0.8860), AUC: 0.9152, TopKAcc: 0.6055
=== Época: 27 ===

Média Train Época 27: Loss: 0.1462, P: 0.9347, R: 0.9307, F1: 0.9303, Acc: 0.9307, AUC: 0.9749, TopKAcc: 0.6491

Média Val Época 27: Loss: 0.2027, P: 0.8698, R: 0.8640, F1: 0.8630, Acc: 0.8640 (Melhor: 0.8860), AUC: 0.9324, TopKAcc: 0.6194
=== Época: 28 ===

Média Train Época 28: Loss: 0.1289, P: 0.9435, R: 0.9390, F1: 0.9387, Acc: 0.9390, AUC: 0.9839, TopKAcc: 0.6734

Média Val Época 28: Loss: 0.1890, P: 0.8955, R: 0.8893, F1: 0.8885, Acc: 0.8893 (Melhor), AUC: 0.9446, TopKAcc: 0.6348
Nova melhor acurácia de validação: 0.8893. Salvando modelo...
=== Época: 29 ===

Média Train Época 29: Loss: 0.1366, P: 0.9427, R: 0.9383, F1: 0.9380, Acc: 0.9383, AUC: 0.9823, TopKAcc: 0.6660

Média Val Época 29: Loss: 0.1904, P: 0.8836, R: 0.8783, F1: 0.8776, Acc: 0.8783 (Melhor: 0.8893), AUC: 0.9367, TopKAcc: 0.6254
=== Época: 30 ===

Média Train Época 30: Loss: 0.1339, P: 0.9381, R: 0.9337, F1: 0.9333, Acc: 0.9337, AUC: 0.9808, TopKAcc: 0.6581

Média Val Época 30: Loss: 0.2150, P: 0.8623, R: 0.8567, F1: 0.8556, Acc: 0.8567 (Melhor: 0.8893), AUC: 0.9234, TopKAcc: 0.6183
=== Época: 31 ===

Média Train Época 31: Loss: 0.1351, P: 0.9414, R: 0.9360, F1: 0.9355, Acc: 0.9360, AUC: 0.9841, TopKAcc: 0.6540

Média Val Época 31: Loss: 0.2126, P: 0.8681, R: 0.8620, F1: 0.8610, Acc: 0.8620 (Melhor: 0.8893), AUC: 0.9312, TopKAcc: 0.6073
=== Época: 32 ===

Média Train Época 32: Loss: 0.1302, P: 0.9441, R: 0.9393, F1: 0.9388, Acc: 0.9393, AUC: 0.9829, TopKAcc: 0.6605

Média Val Época 32: Loss: 0.2220, P: 0.8558, R: 0.8483, F1: 0.8467, Acc: 0.8483 (Melhor: 0.8893), AUC: 0.9232, TopKAcc: 0.5984
=== Época: 33 ===

Média Train Época 33: Loss: 0.1232, P: 0.9473, R: 0.9427, F1: 0.9423, Acc: 0.9427, AUC: 0.9892, TopKAcc: 0.6459

Média Val Época 33: Loss: 0.2069, P: 0.8858, R: 0.8797, F1: 0.8788, Acc: 0.8797 (Melhor: 0.8893), AUC: 0.9443, TopKAcc: 0.6169
=== Época: 34 ===

Média Train Época 34: Loss: 0.1187, P: 0.9485, R: 0.9447, F1: 0.9444, Acc: 0.9447, AUC: 0.9886, TopKAcc: 0.6699

Média Val Época 34: Loss: 0.2104, P: 0.8757, R: 0.8690, F1: 0.8679, Acc: 0.8690 (Melhor: 0.8893), AUC: 0.9340, TopKAcc: 0.5996
=== Época: 35 ===

Média Train Época 35: Loss: 0.1234, P: 0.9553, R: 0.9513, F1: 0.9511, Acc: 0.9513, AUC: 0.9907, TopKAcc: 0.6632

Média Val Época 35: Loss: 0.2208, P: 0.8683, R: 0.8600, F1: 0.8584, Acc: 0.8600 (Melhor: 0.8893), AUC: 0.9268, TopKAcc: 0.5979
=== Época: 36 ===

Média Train Época 36: Loss: 0.1228, P: 0.9509, R: 0.9470, F1: 0.9468, Acc: 0.9470, AUC: 0.9886, TopKAcc: 0.6453

Média Val Época 36: Loss: 0.1999, P: 0.8836, R: 0.8750, F1: 0.8731, Acc: 0.8750 (Melhor: 0.8893), AUC: 0.9347, TopKAcc: 0.6168
=== Época: 37 ===

Média Train Época 37: Loss: 0.1251, P: 0.9519, R: 0.9473, F1: 0.9470, Acc: 0.9473, AUC: 0.9918, TopKAcc: 0.6422

Média Val Época 37: Loss: 0.2055, P: 0.8892, R: 0.8827, F1: 0.8814, Acc: 0.8827 (Melhor: 0.8893), AUC: 0.9455, TopKAcc: 0.6305
=== Época: 38 ===

Média Train Época 38: Loss: 0.1281, P: 0.9499, R: 0.9447, F1: 0.9442, Acc: 0.9447, AUC: 0.9874, TopKAcc: 0.6459

Média Val Época 38: Loss: 0.2107, P: 0.8698, R: 0.8623, F1: 0.8606, Acc: 0.8623 (Melhor: 0.8893), AUC: 0.9322, TopKAcc: 0.6019
=== Época: 39 ===

Média Train Época 39: Loss: 0.1152, P: 0.9562, R: 0.9517, F1: 0.9514, Acc: 0.9517, AUC: 0.9927, TopKAcc: 0.6518

Média Val Época 39: Loss: 0.2019, P: 0.8821, R: 0.8777, F1: 0.8769, Acc: 0.8777 (Melhor: 0.8893), AUC: 0.9322, TopKAcc: 0.6167
=== Época: 40 ===

Média Train Época 40: Loss: 0.1152, P: 0.9544, R: 0.9507, F1: 0.9504, Acc: 0.9507, AUC: 0.9915, TopKAcc: 0.6630

Média Val Época 40: Loss: 0.2062, P: 0.8764, R: 0.8687, F1: 0.8673, Acc: 0.8687 (Melhor: 0.8893), AUC: 0.9384, TopKAcc: 0.6004
=== Época: 41 ===

Média Train Época 41: Loss: 0.1094, P: 0.9646, R: 0.9617, F1: 0.9614, Acc: 0.9617, AUC: 0.9934, TopKAcc: 0.6619

Média Val Época 41: Loss: 0.1947, P: 0.8926, R: 0.8847, F1: 0.8837, Acc: 0.8847 (Melhor: 0.8893), AUC: 0.9517, TopKAcc: 0.6185
=== Época: 42 ===

Média Train Época 42: Loss: 0.1111, P: 0.9610, R: 0.9577, F1: 0.9575, Acc: 0.9577, AUC: 0.9924, TopKAcc: 0.6647

Média Val Época 42: Loss: 0.1992, P: 0.8803, R: 0.8733, F1: 0.8724, Acc: 0.8733 (Melhor: 0.8893), AUC: 0.9410, TopKAcc: 0.6243
=== Época: 43 ===

Média Train Época 43: Loss: 0.1148, P: 0.9566, R: 0.9523, F1: 0.9520, Acc: 0.9523, AUC: 0.9936, TopKAcc: 0.6458

Média Val Época 43: Loss: 0.2142, P: 0.8690, R: 0.8607, F1: 0.8595, Acc: 0.8607 (Melhor: 0.8893), AUC: 0.9320, TopKAcc: 0.6109
=== Época: 44 ===

Média Train Época 44: Loss: 0.1136, P: 0.9508, R: 0.9470, F1: 0.9468, Acc: 0.9470, AUC: 0.9932, TopKAcc: 0.6567

Média Val Época 44: Loss: 0.1995, P: 0.8865, R: 0.8800, F1: 0.8789, Acc: 0.8800 (Melhor: 0.8893), AUC: 0.9397, TopKAcc: 0.6204
=== Época: 45 ===

Média Train Época 45: Loss: 0.1065, P: 0.9658, R: 0.9627, F1: 0.9625, Acc: 0.9627, AUC: 0.9943, TopKAcc: 0.6602

Média Val Época 45: Loss: 0.1924, P: 0.8975, R: 0.8927, F1: 0.8920, Acc: 0.8927 (Melhor), AUC: 0.9534, TopKAcc: 0.6229
Nova melhor acurácia de validação: 0.8927. Salvando modelo...
=== Época: 46 ===

Média Train Época 46: Loss: 0.1164, P: 0.9645, R: 0.9613, F1: 0.9611, Acc: 0.9613, AUC: 0.9926, TopKAcc: 0.6552

Média Val Época 46: Loss: 0.1761, P: 0.9043, R: 0.8980, F1: 0.8973, Acc: 0.8980 (Melhor), AUC: 0.9545, TopKAcc: 0.6244
Nova melhor acurácia de validação: 0.8980. Salvando modelo...
=== Época: 47 ===

Média Train Época 47: Loss: 0.1084, P: 0.9628, R: 0.9597, F1: 0.9595, Acc: 0.9597, AUC: 0.9943, TopKAcc: 0.6536

Média Val Época 47: Loss: 0.2079, P: 0.8793, R: 0.8737, F1: 0.8729, Acc: 0.8737 (Melhor: 0.8980), AUC: 0.9412, TopKAcc: 0.6051
=== Época: 48 ===

Média Train Época 48: Loss: 0.1188, P: 0.9568, R: 0.9520, F1: 0.9517, Acc: 0.9520, AUC: 0.9948, TopKAcc: 0.6388

Média Val Época 48: Loss: 0.2078, P: 0.8699, R: 0.8640, F1: 0.8630, Acc: 0.8640 (Melhor: 0.8980), AUC: 0.9339, TopKAcc: 0.6098
=== Época: 49 ===

Média Train Época 49: Loss: 0.1111, P: 0.9613, R: 0.9573, F1: 0.9571, Acc: 0.9573, AUC: 0.9949, TopKAcc: 0.6497

Média Val Época 49: Loss: 0.1986, P: 0.8873, R: 0.8800, F1: 0.8790, Acc: 0.8800 (Melhor: 0.8980), AUC: 0.9394, TopKAcc: 0.6106
=== Época: 50 ===

Média Train Época 50: Loss: 0.1112, P: 0.9622, R: 0.9577, F1: 0.9574, Acc: 0.9577, AUC: 0.9957, TopKAcc: 0.6492

Média Val Época 50: Loss: 0.2033, P: 0.8766, R: 0.8687, F1: 0.8676, Acc: 0.8687 (Melhor: 0.8980), AUC: 0.9403, TopKAcc: 0.6045
=== Época: 51 ===

Média Train Época 51: Loss: 0.1168, P: 0.9565, R: 0.9523, F1: 0.9521, Acc: 0.9523, AUC: 0.9941, TopKAcc: 0.6370

Média Val Época 51: Loss: 0.1824, P: 0.9035, R: 0.8983, F1: 0.8978, Acc: 0.8983 (Melhor), AUC: 0.9564, TopKAcc: 0.6286
Nova melhor acurácia de validação: 0.8983. Salvando modelo...
=== Época: 52 ===

Média Train Época 52: Loss: 0.1127, P: 0.9571, R: 0.9523, F1: 0.9520, Acc: 0.9523, AUC: 0.9940, TopKAcc: 0.6586

Média Val Época 52: Loss: 0.2031, P: 0.8794, R: 0.8723, F1: 0.8714, Acc: 0.8723 (Melhor: 0.8983), AUC: 0.9423, TopKAcc: 0.6294
=== Época: 53 ===

Média Train Época 53: Loss: 0.1091, P: 0.9600, R: 0.9550, F1: 0.9546, Acc: 0.9550, AUC: 0.9942, TopKAcc: 0.6470

Média Val Época 53: Loss: 0.2193, P: 0.8651, R: 0.8550, F1: 0.8536, Acc: 0.8550 (Melhor: 0.8983), AUC: 0.9387, TopKAcc: 0.6130
=== Época: 54 ===

Média Train Época 54: Loss: 0.1084, P: 0.9637, R: 0.9600, F1: 0.9598, Acc: 0.9600, AUC: 0.9960, TopKAcc: 0.6682

Média Val Época 54: Loss: 0.1995, P: 0.8769, R: 0.8707, F1: 0.8698, Acc: 0.8707 (Melhor: 0.8983), AUC: 0.9355, TopKAcc: 0.6083
=== Época: 55 ===

Média Train Época 55: Loss: 0.1097, P: 0.9623, R: 0.9587, F1: 0.9585, Acc: 0.9587, AUC: 0.9946, TopKAcc: 0.6504

Média Val Época 55: Loss: 0.1951, P: 0.8846, R: 0.8770, F1: 0.8760, Acc: 0.8770 (Melhor: 0.8983), AUC: 0.9472, TopKAcc: 0.6016
=== Época: 56 ===

Média Train Época 56: Loss: 0.1085, P: 0.9647, R: 0.9600, F1: 0.9597, Acc: 0.9600, AUC: 0.9956, TopKAcc: 0.6615

Média Val Época 56: Loss: 0.1834, P: 0.8892, R: 0.8837, F1: 0.8830, Acc: 0.8837 (Melhor: 0.8983), AUC: 0.9483, TopKAcc: 0.6274
=== Época: 57 ===

Média Train Época 57: Loss: 0.1071, P: 0.9642, R: 0.9610, F1: 0.9608, Acc: 0.9610, AUC: 0.9949, TopKAcc: 0.6617

Média Val Época 57: Loss: 0.1967, P: 0.8875, R: 0.8807, F1: 0.8798, Acc: 0.8807 (Melhor: 0.8983), AUC: 0.9423, TopKAcc: 0.6144
=== Época: 58 ===

Média Train Época 58: Loss: 0.1105, P: 0.9605, R: 0.9567, F1: 0.9564, Acc: 0.9567, AUC: 0.9955, TopKAcc: 0.6508

Média Val Época 58: Loss: 0.1808, P: 0.8963, R: 0.8897, F1: 0.8883, Acc: 0.8897 (Melhor: 0.8983), AUC: 0.9545, TopKAcc: 0.6397
=== Época: 59 ===

Média Train Época 59: Loss: 0.1071, P: 0.9642, R: 0.9607, F1: 0.9605, Acc: 0.9607, AUC: 0.9959, TopKAcc: 0.6556

Média Val Época 59: Loss: 0.1864, P: 0.9009, R: 0.8943, F1: 0.8935, Acc: 0.8943 (Melhor: 0.8983), AUC: 0.9568, TopKAcc: 0.6124
=== Época: 60 ===

Média Train Época 60: Loss: 0.1032, P: 0.9667, R: 0.9633, F1: 0.9632, Acc: 0.9633, AUC: 0.9967, TopKAcc: 0.6661

Média Val Época 60: Loss: 0.2088, P: 0.8718, R: 0.8657, F1: 0.8648, Acc: 0.8657 (Melhor: 0.8983), AUC: 0.9380, TopKAcc: 0.5955
=== Época: 61 ===

Média Train Época 61: Loss: 0.1012, P: 0.9683, R: 0.9647, F1: 0.9645, Acc: 0.9647, AUC: 0.9976, TopKAcc: 0.6546

Média Val Época 61: Loss: 0.1918, P: 0.8911, R: 0.8840, F1: 0.8831, Acc: 0.8840 (Melhor: 0.8983), AUC: 0.9544, TopKAcc: 0.6079
=== Época: 62 ===

Média Train Época 62: Loss: 0.1073, P: 0.9606, R: 0.9557, F1: 0.9553, Acc: 0.9557, AUC: 0.9965, TopKAcc: 0.6396

Média Val Época 62: Loss: 0.1854, P: 0.8964, R: 0.8880, F1: 0.8869, Acc: 0.8880 (Melhor: 0.8983), AUC: 0.9564, TopKAcc: 0.6200
=== Época: 63 ===

Média Train Época 63: Loss: 0.1006, P: 0.9632, R: 0.9587, F1: 0.9584, Acc: 0.9587, AUC: 0.9964, TopKAcc: 0.6633

Média Val Época 63: Loss: 0.2038, P: 0.8702, R: 0.8630, F1: 0.8619, Acc: 0.8630 (Melhor: 0.8983), AUC: 0.9333, TopKAcc: 0.6145
=== Época: 64 ===

Média Train Época 64: Loss: 0.1055, P: 0.9650, R: 0.9613, F1: 0.9612, Acc: 0.9613, AUC: 0.9975, TopKAcc: 0.6540

Média Val Época 64: Loss: 0.1934, P: 0.8843, R: 0.8773, F1: 0.8765, Acc: 0.8773 (Melhor: 0.8983), AUC: 0.9422, TopKAcc: 0.6219
=== Época: 65 ===

Média Train Época 65: Loss: 0.0984, P: 0.9659, R: 0.9620, F1: 0.9618, Acc: 0.9620, AUC: 0.9976, TopKAcc: 0.6597

Média Val Época 65: Loss: 0.2036, P: 0.8769, R: 0.8697, F1: 0.8687, Acc: 0.8697 (Melhor: 0.8983), AUC: 0.9364, TopKAcc: 0.6168
=== Época: 66 ===

Média Train Época 66: Loss: 0.1027, P: 0.9626, R: 0.9577, F1: 0.9573, Acc: 0.9577, AUC: 0.9968, TopKAcc: 0.6639

Média Val Época 66: Loss: 0.1851, P: 0.8886, R: 0.8810, F1: 0.8800, Acc: 0.8810 (Melhor: 0.8983), AUC: 0.9473, TopKAcc: 0.6253
=== Época: 67 ===

Média Train Época 67: Loss: 0.1081, P: 0.9561, R: 0.9503, F1: 0.9500, Acc: 0.9503, AUC: 0.9964, TopKAcc: 0.6609

Média Val Época 67: Loss: 0.1995, P: 0.8750, R: 0.8643, F1: 0.8624, Acc: 0.8643 (Melhor: 0.8983), AUC: 0.9442, TopKAcc: 0.5987
=== Época: 68 ===

Média Train Época 68: Loss: 0.1007, P: 0.9675, R: 0.9633, F1: 0.9631, Acc: 0.9633, AUC: 0.9974, TopKAcc: 0.6640

Média Val Época 68: Loss: 0.1926, P: 0.8854, R: 0.8793, F1: 0.8784, Acc: 0.8793 (Melhor: 0.8983), AUC: 0.9370, TopKAcc: 0.6536
=== Época: 69 ===

Média Train Época 69: Loss: 0.1033, P: 0.9650, R: 0.9600, F1: 0.9597, Acc: 0.9600, AUC: 0.9980, TopKAcc: 0.6541

Média Val Época 69: Loss: 0.2020, P: 0.8725, R: 0.8637, F1: 0.8624, Acc: 0.8637 (Melhor: 0.8983), AUC: 0.9412, TopKAcc: 0.6083
=== Época: 70 ===

Média Train Época 70: Loss: 0.1040, P: 0.9619, R: 0.9567, F1: 0.9563, Acc: 0.9567, AUC: 0.9972, TopKAcc: 0.6661

Média Val Época 70: Loss: 0.1900, P: 0.8838, R: 0.8773, F1: 0.8765, Acc: 0.8773 (Melhor: 0.8983), AUC: 0.9430, TopKAcc: 0.6366
=== Época: 71 ===

Média Train Época 71: Loss: 0.1029, P: 0.9617, R: 0.9570, F1: 0.9567, Acc: 0.9570, AUC: 0.9964, TopKAcc: 0.6656

Média Val Época 71: Loss: 0.1850, P: 0.9010, R: 0.8957, F1: 0.8949, Acc: 0.8957 (Melhor: 0.8983), AUC: 0.9510, TopKAcc: 0.6357
=== Época: 72 ===
Parando cedo na época 72.
Treinamento concluído.
Carregando o melhor estado do modelo (da validação) para teste.

Testando com o melhor modelo...

Resultados Finais do Teste
Test Loss: 0.1858
Test Acc: 0.8891
Test P (macro): 0.8954
Test R (macro): 0.8891
Test F1 (macro): 0.8883
Test AUC: 0.9512
Test TopKAcc: 0.6407
--- Verificando/Rodando Fold 04 (k-shot = 55) ---
Rodando Fold 04...
Gerando dicionário de rótulos a partir de: data/QEvasionCorpus/few_shot/04/train.json
Dicionário de rótulos criado com sucesso: {'Claims ignorance': 0, 'Clarification': 1, 'Declining to answer': 2, 'Deflection': 3, 'Dodging': 4, 'Explicit': 5, 'General': 6, 'Implicit': 7, 'Partial/half-answer': 8}
Usando GPU: 0
Carregando encoder genérico: BAAI/bge-m3

Inicializando Dataloader de Treino...
Indexando data/QEvasionCorpus/few_shot/04/train.json...

Inicializando Dataloader de Validação...
Indexando data/QEvasionCorpus/few_shot/04/valid.json...

Inicializando Dataloader de Teste...
Indexando data/QEvasionCorpus/few_shot/04/test.json...
=== Época: 0 ===

Média Train Época 0: Loss: 0.7083, P: 0.7507, R: 0.7400, F1: 0.7373, Acc: 0.7400, AUC: 0.8208, TopKAcc: 0.5748

Média Val Época 0: Loss: 0.2751, P: 0.7908, R: 0.7830, F1: 0.7813, Acc: 0.7830 (Melhor), AUC: 0.8477, TopKAcc: 0.5877
Nova melhor acurácia de validação: 0.7830. Salvando modelo...
=== Época: 1 ===

Média Train Época 1: Loss: 0.2795, P: 0.7745, R: 0.7670, F1: 0.7650, Acc: 0.7670, AUC: 0.8309, TopKAcc: 0.5881

Média Val Época 1: Loss: 0.2314, P: 0.8182, R: 0.8110, F1: 0.8097, Acc: 0.8110 (Melhor), AUC: 0.8747, TopKAcc: 0.6483
Nova melhor acurácia de validação: 0.8110. Salvando modelo...
=== Época: 2 ===

Média Train Época 2: Loss: 0.2536, P: 0.8130, R: 0.8057, F1: 0.8040, Acc: 0.8057, AUC: 0.8628, TopKAcc: 0.6150

Média Val Época 2: Loss: 0.2461, P: 0.8107, R: 0.8037, F1: 0.8021, Acc: 0.8037 (Melhor: 0.8110), AUC: 0.8640, TopKAcc: 0.6350
=== Época: 3 ===

Média Train Época 3: Loss: 0.2405, P: 0.8172, R: 0.8077, F1: 0.8055, Acc: 0.8077, AUC: 0.8700, TopKAcc: 0.6284

Média Val Época 3: Loss: 0.2194, P: 0.8435, R: 0.8363, F1: 0.8346, Acc: 0.8363 (Melhor), AUC: 0.8856, TopKAcc: 0.6659
Nova melhor acurácia de validação: 0.8363. Salvando modelo...
=== Época: 4 ===

Média Train Época 4: Loss: 0.2210, P: 0.8339, R: 0.8260, F1: 0.8244, Acc: 0.8260, AUC: 0.8884, TopKAcc: 0.6518

Média Val Época 4: Loss: 0.2182, P: 0.8419, R: 0.8360, F1: 0.8349, Acc: 0.8360 (Melhor: 0.8363), AUC: 0.8920, TopKAcc: 0.6668
=== Época: 5 ===

Média Train Época 5: Loss: 0.2084, P: 0.8516, R: 0.8430, F1: 0.8413, Acc: 0.8430, AUC: 0.9044, TopKAcc: 0.6590

Média Val Época 5: Loss: 0.2308, P: 0.8220, R: 0.8147, F1: 0.8131, Acc: 0.8147 (Melhor: 0.8363), AUC: 0.8766, TopKAcc: 0.6486
=== Época: 6 ===

Média Train Época 6: Loss: 0.2219, P: 0.8303, R: 0.8240, F1: 0.8225, Acc: 0.8240, AUC: 0.8887, TopKAcc: 0.6444

Média Val Época 6: Loss: 0.1991, P: 0.8534, R: 0.8473, F1: 0.8460, Acc: 0.8473 (Melhor), AUC: 0.9038, TopKAcc: 0.6859
Nova melhor acurácia de validação: 0.8473. Salvando modelo...
=== Época: 7 ===

Média Train Época 7: Loss: 0.2123, P: 0.8512, R: 0.8460, F1: 0.8446, Acc: 0.8460, AUC: 0.9034, TopKAcc: 0.6433

Média Val Época 7: Loss: 0.2064, P: 0.8492, R: 0.8437, F1: 0.8426, Acc: 0.8437 (Melhor: 0.8473), AUC: 0.9112, TopKAcc: 0.6731
=== Época: 8 ===

Média Train Época 8: Loss: 0.2095, P: 0.8497, R: 0.8443, F1: 0.8430, Acc: 0.8443, AUC: 0.8996, TopKAcc: 0.6487

Média Val Época 8: Loss: 0.2147, P: 0.8469, R: 0.8417, F1: 0.8406, Acc: 0.8417 (Melhor: 0.8473), AUC: 0.9036, TopKAcc: 0.6504
=== Época: 9 ===

Média Train Época 9: Loss: 0.1869, P: 0.8698, R: 0.8630, F1: 0.8619, Acc: 0.8630, AUC: 0.9274, TopKAcc: 0.6732

Média Val Época 9: Loss: 0.2120, P: 0.8508, R: 0.8450, F1: 0.8434, Acc: 0.8450 (Melhor: 0.8473), AUC: 0.8944, TopKAcc: 0.6631
=== Época: 10 ===

Média Train Época 10: Loss: 0.1979, P: 0.8605, R: 0.8550, F1: 0.8539, Acc: 0.8550, AUC: 0.9036, TopKAcc: 0.6643

Média Val Época 10: Loss: 0.2144, P: 0.8321, R: 0.8273, F1: 0.8263, Acc: 0.8273 (Melhor: 0.8473), AUC: 0.8893, TopKAcc: 0.6632
=== Época: 11 ===

Média Train Época 11: Loss: 0.1847, P: 0.8893, R: 0.8817, F1: 0.8805, Acc: 0.8817, AUC: 0.9366, TopKAcc: 0.6693

Média Val Época 11: Loss: 0.2194, P: 0.8338, R: 0.8280, F1: 0.8267, Acc: 0.8280 (Melhor: 0.8473), AUC: 0.8909, TopKAcc: 0.6468
=== Época: 12 ===

Média Train Época 12: Loss: 0.1649, P: 0.8964, R: 0.8923, F1: 0.8918, Acc: 0.8923, AUC: 0.9449, TopKAcc: 0.6779

Média Val Época 12: Loss: 0.2092, P: 0.8470, R: 0.8403, F1: 0.8385, Acc: 0.8403 (Melhor: 0.8473), AUC: 0.8997, TopKAcc: 0.6599
=== Época: 13 ===

Média Train Época 13: Loss: 0.1757, P: 0.8854, R: 0.8787, F1: 0.8765, Acc: 0.8787, AUC: 0.9354, TopKAcc: 0.6675

Média Val Época 13: Loss: 0.2073, P: 0.8490, R: 0.8427, F1: 0.8408, Acc: 0.8427 (Melhor: 0.8473), AUC: 0.9006, TopKAcc: 0.6661
=== Época: 14 ===

Média Train Época 14: Loss: 0.1829, P: 0.8749, R: 0.8683, F1: 0.8669, Acc: 0.8683, AUC: 0.9297, TopKAcc: 0.6631

Média Val Época 14: Loss: 0.1975, P: 0.8680, R: 0.8630, F1: 0.8617, Acc: 0.8630 (Melhor), AUC: 0.9187, TopKAcc: 0.6582
Nova melhor acurácia de validação: 0.8630. Salvando modelo...
=== Época: 15 ===

Média Train Época 15: Loss: 0.1787, P: 0.8995, R: 0.8940, F1: 0.8930, Acc: 0.8940, AUC: 0.9421, TopKAcc: 0.6594

Média Val Época 15: Loss: 0.1882, P: 0.8707, R: 0.8640, F1: 0.8623, Acc: 0.8640 (Melhor), AUC: 0.9269, TopKAcc: 0.6717
Nova melhor acurácia de validação: 0.8640. Salvando modelo...
=== Época: 16 ===

Média Train Época 16: Loss: 0.1786, P: 0.8883, R: 0.8823, F1: 0.8814, Acc: 0.8823, AUC: 0.9426, TopKAcc: 0.6600

Média Val Época 16: Loss: 0.1933, P: 0.8820, R: 0.8743, F1: 0.8732, Acc: 0.8743 (Melhor), AUC: 0.9345, TopKAcc: 0.6542
Nova melhor acurácia de validação: 0.8743. Salvando modelo...
=== Época: 17 ===

Média Train Época 17: Loss: 0.1709, P: 0.9002, R: 0.8937, F1: 0.8926, Acc: 0.8937, AUC: 0.9484, TopKAcc: 0.6684

Média Val Época 17: Loss: 0.2070, P: 0.8711, R: 0.8623, F1: 0.8606, Acc: 0.8623 (Melhor: 0.8743), AUC: 0.9223, TopKAcc: 0.6351
=== Época: 18 ===

Média Train Época 18: Loss: 0.1466, P: 0.9270, R: 0.9210, F1: 0.9202, Acc: 0.9210, AUC: 0.9709, TopKAcc: 0.6791

Média Val Época 18: Loss: 0.1898, P: 0.8796, R: 0.8723, F1: 0.8710, Acc: 0.8723 (Melhor: 0.8743), AUC: 0.9328, TopKAcc: 0.6481
=== Época: 19 ===

Média Train Época 19: Loss: 0.1569, P: 0.9144, R: 0.9070, F1: 0.9061, Acc: 0.9070, AUC: 0.9610, TopKAcc: 0.6660

Média Val Época 19: Loss: 0.1853, P: 0.8843, R: 0.8777, F1: 0.8768, Acc: 0.8777 (Melhor), AUC: 0.9403, TopKAcc: 0.6642
Nova melhor acurácia de validação: 0.8777. Salvando modelo...
=== Época: 20 ===

Média Train Época 20: Loss: 0.1409, P: 0.9290, R: 0.9250, F1: 0.9246, Acc: 0.9250, AUC: 0.9697, TopKAcc: 0.6835

Média Val Época 20: Loss: 0.1893, P: 0.8917, R: 0.8817, F1: 0.8797, Acc: 0.8817 (Melhor), AUC: 0.9435, TopKAcc: 0.6385
Nova melhor acurácia de validação: 0.8817. Salvando modelo...
=== Época: 21 ===

Média Train Época 21: Loss: 0.1422, P: 0.9308, R: 0.9240, F1: 0.9231, Acc: 0.9240, AUC: 0.9745, TopKAcc: 0.6711

Média Val Época 21: Loss: 0.1934, P: 0.8721, R: 0.8663, F1: 0.8650, Acc: 0.8663 (Melhor: 0.8817), AUC: 0.9269, TopKAcc: 0.6453
=== Época: 22 ===

Média Train Época 22: Loss: 0.1439, P: 0.9223, R: 0.9173, F1: 0.9168, Acc: 0.9173, AUC: 0.9709, TopKAcc: 0.6640

Média Val Época 22: Loss: 0.2079, P: 0.8715, R: 0.8640, F1: 0.8627, Acc: 0.8640 (Melhor: 0.8817), AUC: 0.9263, TopKAcc: 0.6387
=== Época: 23 ===

Média Train Época 23: Loss: 0.1384, P: 0.9334, R: 0.9290, F1: 0.9284, Acc: 0.9290, AUC: 0.9769, TopKAcc: 0.6695

Média Val Época 23: Loss: 0.1847, P: 0.8914, R: 0.8870, F1: 0.8863, Acc: 0.8870 (Melhor), AUC: 0.9400, TopKAcc: 0.6452
Nova melhor acurácia de validação: 0.8870. Salvando modelo...
=== Época: 24 ===

Média Train Época 24: Loss: 0.1470, P: 0.9279, R: 0.9220, F1: 0.9213, Acc: 0.9220, AUC: 0.9704, TopKAcc: 0.6612

Média Val Época 24: Loss: 0.1840, P: 0.8966, R: 0.8877, F1: 0.8866, Acc: 0.8877 (Melhor), AUC: 0.9525, TopKAcc: 0.6409
Nova melhor acurácia de validação: 0.8877. Salvando modelo...
=== Época: 25 ===

Média Train Época 25: Loss: 0.1255, P: 0.9536, R: 0.9490, F1: 0.9485, Acc: 0.9490, AUC: 0.9859, TopKAcc: 0.6779

Média Val Época 25: Loss: 0.1950, P: 0.8828, R: 0.8743, F1: 0.8727, Acc: 0.8743 (Melhor: 0.8877), AUC: 0.9368, TopKAcc: 0.6326
=== Época: 26 ===

Média Train Época 26: Loss: 0.1453, P: 0.9299, R: 0.9247, F1: 0.9240, Acc: 0.9247, AUC: 0.9724, TopKAcc: 0.6603

Média Val Época 26: Loss: 0.2084, P: 0.8719, R: 0.8630, F1: 0.8613, Acc: 0.8630 (Melhor: 0.8877), AUC: 0.9307, TopKAcc: 0.6102
=== Época: 27 ===

Média Train Época 27: Loss: 0.1376, P: 0.9376, R: 0.9323, F1: 0.9319, Acc: 0.9323, AUC: 0.9810, TopKAcc: 0.6598

Média Val Época 27: Loss: 0.2018, P: 0.8755, R: 0.8677, F1: 0.8662, Acc: 0.8677 (Melhor: 0.8877), AUC: 0.9351, TopKAcc: 0.6190
=== Época: 28 ===

Média Train Época 28: Loss: 0.1288, P: 0.9415, R: 0.9363, F1: 0.9358, Acc: 0.9363, AUC: 0.9819, TopKAcc: 0.6770

Média Val Época 28: Loss: 0.1858, P: 0.8972, R: 0.8927, F1: 0.8920, Acc: 0.8927 (Melhor), AUC: 0.9468, TopKAcc: 0.6243
Nova melhor acurácia de validação: 0.8927. Salvando modelo...
=== Época: 29 ===

Média Train Época 29: Loss: 0.1406, P: 0.9420, R: 0.9363, F1: 0.9359, Acc: 0.9363, AUC: 0.9859, TopKAcc: 0.6467

Média Val Época 29: Loss: 0.2130, P: 0.8790, R: 0.8700, F1: 0.8685, Acc: 0.8700 (Melhor: 0.8927), AUC: 0.9393, TopKAcc: 0.6097
=== Época: 30 ===

Média Train Época 30: Loss: 0.1246, P: 0.9583, R: 0.9540, F1: 0.9537, Acc: 0.9540, AUC: 0.9903, TopKAcc: 0.6521

Média Val Época 30: Loss: 0.2142, P: 0.8729, R: 0.8637, F1: 0.8622, Acc: 0.8637 (Melhor: 0.8927), AUC: 0.9316, TopKAcc: 0.6018
=== Época: 31 ===

Média Train Época 31: Loss: 0.1345, P: 0.9440, R: 0.9393, F1: 0.9390, Acc: 0.9393, AUC: 0.9855, TopKAcc: 0.6483

Média Val Época 31: Loss: 0.2033, P: 0.8792, R: 0.8723, F1: 0.8715, Acc: 0.8723 (Melhor: 0.8927), AUC: 0.9349, TopKAcc: 0.6101
=== Época: 32 ===

Média Train Época 32: Loss: 0.1250, P: 0.9485, R: 0.9437, F1: 0.9433, Acc: 0.9437, AUC: 0.9891, TopKAcc: 0.6557

Média Val Época 32: Loss: 0.1927, P: 0.8878, R: 0.8800, F1: 0.8789, Acc: 0.8800 (Melhor: 0.8927), AUC: 0.9455, TopKAcc: 0.6177
=== Época: 33 ===

Média Train Época 33: Loss: 0.1280, P: 0.9484, R: 0.9433, F1: 0.9429, Acc: 0.9433, AUC: 0.9847, TopKAcc: 0.6581

Média Val Época 33: Loss: 0.1896, P: 0.8788, R: 0.8713, F1: 0.8700, Acc: 0.8713 (Melhor: 0.8927), AUC: 0.9388, TopKAcc: 0.6161
=== Época: 34 ===

Média Train Época 34: Loss: 0.1245, P: 0.9408, R: 0.9353, F1: 0.9348, Acc: 0.9353, AUC: 0.9853, TopKAcc: 0.6709

Média Val Época 34: Loss: 0.1960, P: 0.8824, R: 0.8780, F1: 0.8773, Acc: 0.8780 (Melhor: 0.8927), AUC: 0.9324, TopKAcc: 0.6415
=== Época: 35 ===

Média Train Época 35: Loss: 0.1187, P: 0.9509, R: 0.9467, F1: 0.9464, Acc: 0.9467, AUC: 0.9902, TopKAcc: 0.6644

Média Val Época 35: Loss: 0.1901, P: 0.8981, R: 0.8910, F1: 0.8901, Acc: 0.8910 (Melhor: 0.8927), AUC: 0.9522, TopKAcc: 0.6069
=== Época: 36 ===

Média Train Época 36: Loss: 0.1172, P: 0.9577, R: 0.9527, F1: 0.9523, Acc: 0.9527, AUC: 0.9920, TopKAcc: 0.6685

Média Val Época 36: Loss: 0.1998, P: 0.8802, R: 0.8723, F1: 0.8713, Acc: 0.8723 (Melhor: 0.8927), AUC: 0.9433, TopKAcc: 0.6046
=== Época: 37 ===

Média Train Época 37: Loss: 0.1147, P: 0.9638, R: 0.9600, F1: 0.9598, Acc: 0.9600, AUC: 0.9946, TopKAcc: 0.6557

Média Val Época 37: Loss: 0.1835, P: 0.8909, R: 0.8840, F1: 0.8831, Acc: 0.8840 (Melhor: 0.8927), AUC: 0.9516, TopKAcc: 0.6113
=== Época: 38 ===

Média Train Época 38: Loss: 0.1221, P: 0.9502, R: 0.9450, F1: 0.9446, Acc: 0.9450, AUC: 0.9915, TopKAcc: 0.6498

Média Val Época 38: Loss: 0.1998, P: 0.8786, R: 0.8693, F1: 0.8678, Acc: 0.8693 (Melhor: 0.8927), AUC: 0.9405, TopKAcc: 0.6138
=== Época: 39 ===

Média Train Época 39: Loss: 0.1251, P: 0.9492, R: 0.9447, F1: 0.9444, Acc: 0.9447, AUC: 0.9899, TopKAcc: 0.6494

Média Val Época 39: Loss: 0.2087, P: 0.8654, R: 0.8567, F1: 0.8552, Acc: 0.8567 (Melhor: 0.8927), AUC: 0.9322, TopKAcc: 0.6023
=== Época: 40 ===

Média Train Época 40: Loss: 0.1321, P: 0.9452, R: 0.9403, F1: 0.9400, Acc: 0.9403, AUC: 0.9889, TopKAcc: 0.6269

Média Val Época 40: Loss: 0.2113, P: 0.8780, R: 0.8680, F1: 0.8665, Acc: 0.8680 (Melhor: 0.8927), AUC: 0.9403, TopKAcc: 0.6091
=== Época: 41 ===

Média Train Época 41: Loss: 0.1264, P: 0.9483, R: 0.9430, F1: 0.9425, Acc: 0.9430, AUC: 0.9885, TopKAcc: 0.6463

Média Val Época 41: Loss: 0.1866, P: 0.8985, R: 0.8887, F1: 0.8877, Acc: 0.8887 (Melhor: 0.8927), AUC: 0.9578, TopKAcc: 0.6073
=== Época: 42 ===

Média Train Época 42: Loss: 0.1334, P: 0.9431, R: 0.9360, F1: 0.9353, Acc: 0.9360, AUC: 0.9900, TopKAcc: 0.6226

Média Val Época 42: Loss: 0.1778, P: 0.9075, R: 0.8980, F1: 0.8968, Acc: 0.8980 (Melhor), AUC: 0.9613, TopKAcc: 0.6383
Nova melhor acurácia de validação: 0.8980. Salvando modelo...
=== Época: 43 ===

Média Train Época 43: Loss: 0.1237, P: 0.9545, R: 0.9490, F1: 0.9486, Acc: 0.9490, AUC: 0.9929, TopKAcc: 0.6356

Média Val Época 43: Loss: 0.1982, P: 0.8842, R: 0.8730, F1: 0.8713, Acc: 0.8730 (Melhor: 0.8980), AUC: 0.9520, TopKAcc: 0.5970
=== Época: 44 ===

Média Train Época 44: Loss: 0.1144, P: 0.9521, R: 0.9467, F1: 0.9463, Acc: 0.9467, AUC: 0.9942, TopKAcc: 0.6586

Média Val Época 44: Loss: 0.1839, P: 0.8954, R: 0.8850, F1: 0.8835, Acc: 0.8850 (Melhor: 0.8980), AUC: 0.9610, TopKAcc: 0.6072
=== Época: 45 ===

Média Train Época 45: Loss: 0.1185, P: 0.9566, R: 0.9513, F1: 0.9509, Acc: 0.9513, AUC: 0.9924, TopKAcc: 0.6490

Média Val Época 45: Loss: 0.1925, P: 0.8884, R: 0.8793, F1: 0.8782, Acc: 0.8793 (Melhor: 0.8980), AUC: 0.9492, TopKAcc: 0.6260
=== Época: 46 ===

Média Train Época 46: Loss: 0.1170, P: 0.9547, R: 0.9497, F1: 0.9494, Acc: 0.9497, AUC: 0.9937, TopKAcc: 0.6454

Média Val Época 46: Loss: 0.1938, P: 0.8899, R: 0.8820, F1: 0.8809, Acc: 0.8820 (Melhor: 0.8980), AUC: 0.9550, TopKAcc: 0.6088
=== Época: 47 ===

Média Train Época 47: Loss: 0.1093, P: 0.9595, R: 0.9547, F1: 0.9543, Acc: 0.9547, AUC: 0.9944, TopKAcc: 0.6705

Média Val Época 47: Loss: 0.1769, P: 0.9008, R: 0.8937, F1: 0.8927, Acc: 0.8937 (Melhor: 0.8980), AUC: 0.9594, TopKAcc: 0.6451
=== Época: 48 ===

Média Train Época 48: Loss: 0.0981, P: 0.9679, R: 0.9647, F1: 0.9644, Acc: 0.9647, AUC: 0.9954, TopKAcc: 0.6838

Média Val Época 48: Loss: 0.1868, P: 0.8871, R: 0.8777, F1: 0.8765, Acc: 0.8777 (Melhor: 0.8980), AUC: 0.9521, TopKAcc: 0.6131
=== Época: 49 ===

Média Train Época 49: Loss: 0.1136, P: 0.9566, R: 0.9520, F1: 0.9517, Acc: 0.9520, AUC: 0.9925, TopKAcc: 0.6593

Média Val Época 49: Loss: 0.1823, P: 0.9091, R: 0.9023, F1: 0.9014, Acc: 0.9023 (Melhor), AUC: 0.9552, TopKAcc: 0.6402
Nova melhor acurácia de validação: 0.9023. Salvando modelo...
=== Época: 50 ===

Média Train Época 50: Loss: 0.1060, P: 0.9643, R: 0.9607, F1: 0.9605, Acc: 0.9607, AUC: 0.9965, TopKAcc: 0.6576

Média Val Época 50: Loss: 0.1980, P: 0.8811, R: 0.8720, F1: 0.8704, Acc: 0.8720 (Melhor: 0.9023), AUC: 0.9453, TopKAcc: 0.6095
=== Época: 51 ===

Média Train Época 51: Loss: 0.1091, P: 0.9616, R: 0.9563, F1: 0.9560, Acc: 0.9563, AUC: 0.9957, TopKAcc: 0.6633

Média Val Época 51: Loss: 0.1810, P: 0.9038, R: 0.8957, F1: 0.8946, Acc: 0.8957 (Melhor: 0.9023), AUC: 0.9557, TopKAcc: 0.6227
=== Época: 52 ===

Média Train Época 52: Loss: 0.1124, P: 0.9639, R: 0.9590, F1: 0.9587, Acc: 0.9590, AUC: 0.9964, TopKAcc: 0.6600

Média Val Época 52: Loss: 0.1866, P: 0.9014, R: 0.8940, F1: 0.8932, Acc: 0.8940 (Melhor: 0.9023), AUC: 0.9575, TopKAcc: 0.6196
=== Época: 53 ===

Média Train Época 53: Loss: 0.1099, P: 0.9580, R: 0.9520, F1: 0.9516, Acc: 0.9520, AUC: 0.9952, TopKAcc: 0.6611

Média Val Época 53: Loss: 0.1786, P: 0.9003, R: 0.8923, F1: 0.8911, Acc: 0.8923 (Melhor: 0.9023), AUC: 0.9543, TopKAcc: 0.6375
=== Época: 54 ===

Média Train Época 54: Loss: 0.0982, P: 0.9612, R: 0.9557, F1: 0.9553, Acc: 0.9557, AUC: 0.9966, TopKAcc: 0.6894

Média Val Época 54: Loss: 0.1741, P: 0.9086, R: 0.9020, F1: 0.9013, Acc: 0.9020 (Melhor: 0.9023), AUC: 0.9630, TopKAcc: 0.6357
=== Época: 55 ===

Média Train Época 55: Loss: 0.1069, P: 0.9629, R: 0.9577, F1: 0.9573, Acc: 0.9577, AUC: 0.9977, TopKAcc: 0.6515

Média Val Época 55: Loss: 0.1760, P: 0.9054, R: 0.8990, F1: 0.8979, Acc: 0.8990 (Melhor: 0.9023), AUC: 0.9669, TopKAcc: 0.6300
=== Época: 56 ===

Média Train Época 56: Loss: 0.1153, P: 0.9516, R: 0.9450, F1: 0.9444, Acc: 0.9450, AUC: 0.9949, TopKAcc: 0.6551

Média Val Época 56: Loss: 0.1814, P: 0.8971, R: 0.8897, F1: 0.8888, Acc: 0.8897 (Melhor: 0.9023), AUC: 0.9544, TopKAcc: 0.6346
=== Época: 57 ===

Média Train Época 57: Loss: 0.1036, P: 0.9629, R: 0.9597, F1: 0.9595, Acc: 0.9597, AUC: 0.9932, TopKAcc: 0.6779

Média Val Época 57: Loss: 0.1818, P: 0.8945, R: 0.8890, F1: 0.8881, Acc: 0.8890 (Melhor: 0.9023), AUC: 0.9508, TopKAcc: 0.6253
=== Época: 58 ===

Média Train Época 58: Loss: 0.1173, P: 0.9578, R: 0.9523, F1: 0.9520, Acc: 0.9523, AUC: 0.9963, TopKAcc: 0.6405

Média Val Época 58: Loss: 0.1907, P: 0.8996, R: 0.8913, F1: 0.8904, Acc: 0.8913 (Melhor: 0.9023), AUC: 0.9596, TopKAcc: 0.6133
=== Época: 59 ===

Média Train Época 59: Loss: 0.1113, P: 0.9586, R: 0.9527, F1: 0.9523, Acc: 0.9527, AUC: 0.9964, TopKAcc: 0.6389

Média Val Época 59: Loss: 0.1944, P: 0.8880, R: 0.8817, F1: 0.8809, Acc: 0.8817 (Melhor: 0.9023), AUC: 0.9484, TopKAcc: 0.6182
=== Época: 60 ===

Média Train Época 60: Loss: 0.1096, P: 0.9564, R: 0.9497, F1: 0.9492, Acc: 0.9497, AUC: 0.9980, TopKAcc: 0.6548

Média Val Época 60: Loss: 0.1827, P: 0.9022, R: 0.8957, F1: 0.8950, Acc: 0.8957 (Melhor: 0.9023), AUC: 0.9559, TopKAcc: 0.6295
=== Época: 61 ===

Média Train Época 61: Loss: 0.1058, P: 0.9647, R: 0.9600, F1: 0.9597, Acc: 0.9600, AUC: 0.9967, TopKAcc: 0.6498

Média Val Época 61: Loss: 0.1853, P: 0.8943, R: 0.8860, F1: 0.8848, Acc: 0.8860 (Melhor: 0.9023), AUC: 0.9584, TopKAcc: 0.6173
=== Época: 62 ===

Média Train Época 62: Loss: 0.1125, P: 0.9574, R: 0.9510, F1: 0.9505, Acc: 0.9510, AUC: 0.9963, TopKAcc: 0.6440

Média Val Época 62: Loss: 0.1973, P: 0.8814, R: 0.8737, F1: 0.8726, Acc: 0.8737 (Melhor: 0.9023), AUC: 0.9463, TopKAcc: 0.5987
=== Época: 63 ===

Média Train Época 63: Loss: 0.1048, P: 0.9617, R: 0.9553, F1: 0.9549, Acc: 0.9553, AUC: 0.9985, TopKAcc: 0.6663

Média Val Época 63: Loss: 0.1829, P: 0.8999, R: 0.8913, F1: 0.8904, Acc: 0.8913 (Melhor: 0.9023), AUC: 0.9603, TopKAcc: 0.6238
=== Época: 64 ===

Média Train Época 64: Loss: 0.1088, P: 0.9599, R: 0.9537, F1: 0.9532, Acc: 0.9537, AUC: 0.9969, TopKAcc: 0.6550

Média Val Época 64: Loss: 0.1813, P: 0.8976, R: 0.8907, F1: 0.8898, Acc: 0.8907 (Melhor: 0.9023), AUC: 0.9542, TopKAcc: 0.6326
=== Época: 65 ===

Média Train Época 65: Loss: 0.1081, P: 0.9587, R: 0.9517, F1: 0.9511, Acc: 0.9517, AUC: 0.9970, TopKAcc: 0.6459

Média Val Época 65: Loss: 0.1922, P: 0.8861, R: 0.8743, F1: 0.8727, Acc: 0.8743 (Melhor: 0.9023), AUC: 0.9521, TopKAcc: 0.5887
=== Época: 66 ===

Média Train Época 66: Loss: 0.1099, P: 0.9555, R: 0.9480, F1: 0.9474, Acc: 0.9480, AUC: 0.9973, TopKAcc: 0.6380

Média Val Época 66: Loss: 0.1994, P: 0.8858, R: 0.8743, F1: 0.8728, Acc: 0.8743 (Melhor: 0.9023), AUC: 0.9535, TopKAcc: 0.5956
=== Época: 67 ===

Média Train Época 67: Loss: 0.1046, P: 0.9590, R: 0.9533, F1: 0.9529, Acc: 0.9533, AUC: 0.9965, TopKAcc: 0.6577

Média Val Época 67: Loss: 0.1919, P: 0.8883, R: 0.8813, F1: 0.8803, Acc: 0.8813 (Melhor: 0.9023), AUC: 0.9514, TopKAcc: 0.6087
=== Época: 68 ===

Média Train Época 68: Loss: 0.1117, P: 0.9561, R: 0.9500, F1: 0.9496, Acc: 0.9500, AUC: 0.9961, TopKAcc: 0.6443

Média Val Época 68: Loss: 0.2016, P: 0.8927, R: 0.8847, F1: 0.8837, Acc: 0.8847 (Melhor: 0.9023), AUC: 0.9517, TopKAcc: 0.6077
=== Época: 69 ===

Média Train Época 69: Loss: 0.1064, P: 0.9590, R: 0.9533, F1: 0.9529, Acc: 0.9533, AUC: 0.9961, TopKAcc: 0.6601

Média Val Época 69: Loss: 0.2001, P: 0.8822, R: 0.8727, F1: 0.8713, Acc: 0.8727 (Melhor: 0.9023), AUC: 0.9499, TopKAcc: 0.5947
=== Época: 70 ===
Parando cedo na época 70.
Treinamento concluído.
Carregando o melhor estado do modelo (da validação) para teste.

Testando com o melhor modelo...

Resultados Finais do Teste
Test Loss: 0.2001
Test Acc: 0.8668
Test P (macro): 0.8766
Test R (macro): 0.8668
Test F1 (macro): 0.8654
Test AUC: 0.9433
Test TopKAcc: 0.6083
--- Verificando/Rodando Fold 05 (k-shot = 55) ---
Rodando Fold 05...
Gerando dicionário de rótulos a partir de: data/QEvasionCorpus/few_shot/05/train.json
Dicionário de rótulos criado com sucesso: {'Claims ignorance': 0, 'Clarification': 1, 'Declining to answer': 2, 'Deflection': 3, 'Dodging': 4, 'Explicit': 5, 'General': 6, 'Implicit': 7, 'Partial/half-answer': 8}
Usando GPU: 0
Carregando encoder genérico: BAAI/bge-m3

Inicializando Dataloader de Treino...
Indexando data/QEvasionCorpus/few_shot/05/train.json...

Inicializando Dataloader de Validação...
Indexando data/QEvasionCorpus/few_shot/05/valid.json...

Inicializando Dataloader de Teste...
Indexando data/QEvasionCorpus/few_shot/05/test.json...
=== Época: 0 ===

Média Train Época 0: Loss: 0.7411, P: 0.7448, R: 0.7353, F1: 0.7322, Acc: 0.7353, AUC: 0.7947, TopKAcc: 0.5670

Média Val Época 0: Loss: 0.2803, P: 0.7732, R: 0.7647, F1: 0.7625, Acc: 0.7647 (Melhor), AUC: 0.8356, TopKAcc: 0.5974
Nova melhor acurácia de validação: 0.7647. Salvando modelo...
=== Época: 1 ===

Média Train Época 1: Loss: 0.2944, P: 0.7582, R: 0.7470, F1: 0.7440, Acc: 0.7470, AUC: 0.8124, TopKAcc: 0.5754

Média Val Época 1: Loss: 0.2619, P: 0.7938, R: 0.7883, F1: 0.7866, Acc: 0.7883 (Melhor), AUC: 0.8579, TopKAcc: 0.6143
Nova melhor acurácia de validação: 0.7883. Salvando modelo...
=== Época: 2 ===

Média Train Época 2: Loss: 0.2739, P: 0.7864, R: 0.7763, F1: 0.7740, Acc: 0.7763, AUC: 0.8422, TopKAcc: 0.5940

Média Val Época 2: Loss: 0.2266, P: 0.8371, R: 0.8323, F1: 0.8313, Acc: 0.8323 (Melhor), AUC: 0.8900, TopKAcc: 0.6535
Nova melhor acurácia de validação: 0.8323. Salvando modelo...
=== Época: 3 ===

Média Train Época 3: Loss: 0.2512, P: 0.7992, R: 0.7920, F1: 0.7904, Acc: 0.7920, AUC: 0.8607, TopKAcc: 0.6205

Média Val Época 3: Loss: 0.2364, P: 0.8177, R: 0.8100, F1: 0.8083, Acc: 0.8100 (Melhor: 0.8323), AUC: 0.8703, TopKAcc: 0.6487
=== Época: 4 ===

Média Train Época 4: Loss: 0.2272, P: 0.8347, R: 0.8277, F1: 0.8262, Acc: 0.8277, AUC: 0.8924, TopKAcc: 0.6370

Média Val Época 4: Loss: 0.2220, P: 0.8265, R: 0.8227, F1: 0.8213, Acc: 0.8227 (Melhor: 0.8323), AUC: 0.8789, TopKAcc: 0.6558
=== Época: 5 ===

Média Train Época 5: Loss: 0.2236, P: 0.8287, R: 0.8217, F1: 0.8200, Acc: 0.8217, AUC: 0.8859, TopKAcc: 0.6484

Média Val Época 5: Loss: 0.2017, P: 0.8480, R: 0.8410, F1: 0.8393, Acc: 0.8410 (Melhor), AUC: 0.9003, TopKAcc: 0.6955
Nova melhor acurácia de validação: 0.8410. Salvando modelo...
=== Época: 6 ===

Média Train Época 6: Loss: 0.2101, P: 0.8538, R: 0.8467, F1: 0.8454, Acc: 0.8467, AUC: 0.9060, TopKAcc: 0.6584

Média Val Época 6: Loss: 0.2286, P: 0.8146, R: 0.8093, F1: 0.8079, Acc: 0.8093 (Melhor: 0.8410), AUC: 0.8789, TopKAcc: 0.6555
=== Época: 7 ===

Média Train Época 7: Loss: 0.2090, P: 0.8477, R: 0.8423, F1: 0.8412, Acc: 0.8423, AUC: 0.8974, TopKAcc: 0.6550

Média Val Época 7: Loss: 0.2037, P: 0.8590, R: 0.8523, F1: 0.8509, Acc: 0.8523 (Melhor), AUC: 0.9036, TopKAcc: 0.6956
Nova melhor acurácia de validação: 0.8523. Salvando modelo...
=== Época: 8 ===

Média Train Época 8: Loss: 0.2119, P: 0.8448, R: 0.8387, F1: 0.8370, Acc: 0.8387, AUC: 0.9036, TopKAcc: 0.6471

Média Val Época 8: Loss: 0.2167, P: 0.8371, R: 0.8313, F1: 0.8293, Acc: 0.8313 (Melhor: 0.8523), AUC: 0.8847, TopKAcc: 0.6543
=== Época: 9 ===

Média Train Época 9: Loss: 0.2132, P: 0.8471, R: 0.8410, F1: 0.8398, Acc: 0.8410, AUC: 0.9035, TopKAcc: 0.6423

Média Val Época 9: Loss: 0.1953, P: 0.8598, R: 0.8560, F1: 0.8553, Acc: 0.8560 (Melhor), AUC: 0.9106, TopKAcc: 0.6788
Nova melhor acurácia de validação: 0.8560. Salvando modelo...
=== Época: 10 ===

Média Train Época 10: Loss: 0.2071, P: 0.8506, R: 0.8440, F1: 0.8420, Acc: 0.8440, AUC: 0.9064, TopKAcc: 0.6498

Média Val Época 10: Loss: 0.2301, P: 0.8249, R: 0.8187, F1: 0.8174, Acc: 0.8187 (Melhor: 0.8560), AUC: 0.8808, TopKAcc: 0.6357
=== Época: 11 ===

Média Train Época 11: Loss: 0.1691, P: 0.8932, R: 0.8873, F1: 0.8865, Acc: 0.8873, AUC: 0.9380, TopKAcc: 0.6816

Média Val Época 11: Loss: 0.2043, P: 0.8410, R: 0.8347, F1: 0.8330, Acc: 0.8347 (Melhor: 0.8560), AUC: 0.9012, TopKAcc: 0.6595
=== Época: 12 ===

Média Train Época 12: Loss: 0.1778, P: 0.8759, R: 0.8703, F1: 0.8693, Acc: 0.8703, AUC: 0.9375, TopKAcc: 0.6730

Média Val Época 12: Loss: 0.2059, P: 0.8506, R: 0.8443, F1: 0.8430, Acc: 0.8443 (Melhor: 0.8560), AUC: 0.9088, TopKAcc: 0.6581
=== Época: 13 ===

Média Train Época 13: Loss: 0.1736, P: 0.8980, R: 0.8917, F1: 0.8904, Acc: 0.8917, AUC: 0.9415, TopKAcc: 0.6681

Média Val Época 13: Loss: 0.2131, P: 0.8557, R: 0.8493, F1: 0.8481, Acc: 0.8493 (Melhor: 0.8560), AUC: 0.9222, TopKAcc: 0.6511
=== Época: 14 ===

Média Train Época 14: Loss: 0.1810, P: 0.8845, R: 0.8783, F1: 0.8771, Acc: 0.8783, AUC: 0.9350, TopKAcc: 0.6627

Média Val Época 14: Loss: 0.1817, P: 0.8783, R: 0.8733, F1: 0.8726, Acc: 0.8733 (Melhor), AUC: 0.9312, TopKAcc: 0.6719
Nova melhor acurácia de validação: 0.8733. Salvando modelo...
=== Época: 15 ===

Média Train Época 15: Loss: 0.1511, P: 0.9200, R: 0.9147, F1: 0.9141, Acc: 0.9147, AUC: 0.9624, TopKAcc: 0.6785

Média Val Época 15: Loss: 0.1932, P: 0.8657, R: 0.8600, F1: 0.8585, Acc: 0.8600 (Melhor: 0.8733), AUC: 0.9201, TopKAcc: 0.6752
=== Época: 16 ===

Média Train Época 16: Loss: 0.1608, P: 0.9074, R: 0.8997, F1: 0.8984, Acc: 0.8997, AUC: 0.9525, TopKAcc: 0.6728

Média Val Época 16: Loss: 0.1920, P: 0.8738, R: 0.8680, F1: 0.8667, Acc: 0.8680 (Melhor: 0.8733), AUC: 0.9240, TopKAcc: 0.6839
=== Época: 17 ===

Média Train Época 17: Loss: 0.1554, P: 0.9116, R: 0.9057, F1: 0.9047, Acc: 0.9057, AUC: 0.9550, TopKAcc: 0.6963

Média Val Época 17: Loss: 0.1748, P: 0.8845, R: 0.8803, F1: 0.8797, Acc: 0.8803 (Melhor), AUC: 0.9358, TopKAcc: 0.6980
Nova melhor acurácia de validação: 0.8803. Salvando modelo...
=== Época: 18 ===

Média Train Época 18: Loss: 0.1607, P: 0.9034, R: 0.8973, F1: 0.8965, Acc: 0.8973, AUC: 0.9521, TopKAcc: 0.6832

Média Val Época 18: Loss: 0.1841, P: 0.8785, R: 0.8723, F1: 0.8713, Acc: 0.8723 (Melhor: 0.8803), AUC: 0.9345, TopKAcc: 0.6844
=== Época: 19 ===

Média Train Época 19: Loss: 0.1489, P: 0.9221, R: 0.9180, F1: 0.9175, Acc: 0.9180, AUC: 0.9608, TopKAcc: 0.6938

Média Val Época 19: Loss: 0.1767, P: 0.8795, R: 0.8743, F1: 0.8734, Acc: 0.8743 (Melhor: 0.8803), AUC: 0.9275, TopKAcc: 0.6988
=== Época: 20 ===

Média Train Época 20: Loss: 0.1358, P: 0.9282, R: 0.9233, F1: 0.9226, Acc: 0.9233, AUC: 0.9719, TopKAcc: 0.7081

Média Val Época 20: Loss: 0.2048, P: 0.8689, R: 0.8597, F1: 0.8581, Acc: 0.8597 (Melhor: 0.8803), AUC: 0.9176, TopKAcc: 0.6574
=== Época: 21 ===

Média Train Época 21: Loss: 0.1613, P: 0.9158, R: 0.9110, F1: 0.9102, Acc: 0.9110, AUC: 0.9537, TopKAcc: 0.6689

Média Val Época 21: Loss: 0.1923, P: 0.8834, R: 0.8773, F1: 0.8761, Acc: 0.8773 (Melhor: 0.8803), AUC: 0.9361, TopKAcc: 0.6443
=== Época: 22 ===

Média Train Época 22: Loss: 0.1519, P: 0.9313, R: 0.9253, F1: 0.9246, Acc: 0.9253, AUC: 0.9682, TopKAcc: 0.6688

Média Val Época 22: Loss: 0.2055, P: 0.8686, R: 0.8617, F1: 0.8605, Acc: 0.8617 (Melhor: 0.8803), AUC: 0.9221, TopKAcc: 0.6399
=== Época: 23 ===

Média Train Época 23: Loss: 0.1533, P: 0.9282, R: 0.9230, F1: 0.9226, Acc: 0.9230, AUC: 0.9720, TopKAcc: 0.6562

Média Val Época 23: Loss: 0.1895, P: 0.8819, R: 0.8753, F1: 0.8742, Acc: 0.8753 (Melhor: 0.8803), AUC: 0.9373, TopKAcc: 0.6472
=== Época: 24 ===

Média Train Época 24: Loss: 0.1478, P: 0.9293, R: 0.9237, F1: 0.9228, Acc: 0.9237, AUC: 0.9660, TopKAcc: 0.6591

Média Val Época 24: Loss: 0.2150, P: 0.8673, R: 0.8590, F1: 0.8572, Acc: 0.8590 (Melhor: 0.8803), AUC: 0.9238, TopKAcc: 0.6095
=== Época: 25 ===

Média Train Época 25: Loss: 0.1383, P: 0.9329, R: 0.9277, F1: 0.9270, Acc: 0.9277, AUC: 0.9772, TopKAcc: 0.6637

Média Val Época 25: Loss: 0.2164, P: 0.8736, R: 0.8663, F1: 0.8653, Acc: 0.8663 (Melhor: 0.8803), AUC: 0.9233, TopKAcc: 0.6109
=== Época: 26 ===

Média Train Época 26: Loss: 0.1524, P: 0.9278, R: 0.9227, F1: 0.9221, Acc: 0.9227, AUC: 0.9708, TopKAcc: 0.6446

Média Val Época 26: Loss: 0.1825, P: 0.8890, R: 0.8847, F1: 0.8839, Acc: 0.8847 (Melhor), AUC: 0.9472, TopKAcc: 0.6348
Nova melhor acurácia de validação: 0.8847. Salvando modelo...
=== Época: 27 ===

Média Train Época 27: Loss: 0.1301, P: 0.9441, R: 0.9407, F1: 0.9401, Acc: 0.9407, AUC: 0.9799, TopKAcc: 0.6665

Média Val Época 27: Loss: 0.2053, P: 0.8809, R: 0.8750, F1: 0.8737, Acc: 0.8750 (Melhor: 0.8847), AUC: 0.9291, TopKAcc: 0.6115
=== Época: 28 ===

Média Train Época 28: Loss: 0.1326, P: 0.9466, R: 0.9423, F1: 0.9419, Acc: 0.9423, AUC: 0.9841, TopKAcc: 0.6497

Média Val Época 28: Loss: 0.2100, P: 0.8754, R: 0.8667, F1: 0.8653, Acc: 0.8667 (Melhor: 0.8847), AUC: 0.9331, TopKAcc: 0.5967
=== Época: 29 ===

Média Train Época 29: Loss: 0.1311, P: 0.9505, R: 0.9463, F1: 0.9460, Acc: 0.9463, AUC: 0.9841, TopKAcc: 0.6538

Média Val Época 29: Loss: 0.2160, P: 0.8591, R: 0.8520, F1: 0.8507, Acc: 0.8520 (Melhor: 0.8847), AUC: 0.9194, TopKAcc: 0.6031
=== Época: 30 ===

Média Train Época 30: Loss: 0.1501, P: 0.9416, R: 0.9360, F1: 0.9355, Acc: 0.9360, AUC: 0.9813, TopKAcc: 0.6242

Média Val Época 30: Loss: 0.2121, P: 0.8720, R: 0.8637, F1: 0.8622, Acc: 0.8637 (Melhor: 0.8847), AUC: 0.9345, TopKAcc: 0.5917
=== Época: 31 ===

Média Train Época 31: Loss: 0.1334, P: 0.9472, R: 0.9433, F1: 0.9430, Acc: 0.9433, AUC: 0.9831, TopKAcc: 0.6431

Média Val Época 31: Loss: 0.2193, P: 0.8608, R: 0.8540, F1: 0.8528, Acc: 0.8540 (Melhor: 0.8847), AUC: 0.9253, TopKAcc: 0.5991
=== Época: 32 ===

Média Train Época 32: Loss: 0.1298, P: 0.9504, R: 0.9450, F1: 0.9446, Acc: 0.9450, AUC: 0.9883, TopKAcc: 0.6384

Média Val Época 32: Loss: 0.1918, P: 0.8814, R: 0.8733, F1: 0.8722, Acc: 0.8733 (Melhor: 0.8847), AUC: 0.9495, TopKAcc: 0.6187
=== Época: 33 ===

Média Train Época 33: Loss: 0.1309, P: 0.9466, R: 0.9423, F1: 0.9420, Acc: 0.9423, AUC: 0.9863, TopKAcc: 0.6421

Média Val Época 33: Loss: 0.2116, P: 0.8694, R: 0.8617, F1: 0.8604, Acc: 0.8617 (Melhor: 0.8847), AUC: 0.9384, TopKAcc: 0.5942
=== Época: 34 ===

Média Train Época 34: Loss: 0.1307, P: 0.9477, R: 0.9427, F1: 0.9423, Acc: 0.9427, AUC: 0.9907, TopKAcc: 0.6385

Média Val Época 34: Loss: 0.2051, P: 0.8634, R: 0.8577, F1: 0.8567, Acc: 0.8577 (Melhor: 0.8847), AUC: 0.9300, TopKAcc: 0.5923
=== Época: 35 ===

Média Train Época 35: Loss: 0.1249, P: 0.9515, R: 0.9477, F1: 0.9474, Acc: 0.9477, AUC: 0.9904, TopKAcc: 0.6405

Média Val Época 35: Loss: 0.1995, P: 0.8856, R: 0.8777, F1: 0.8768, Acc: 0.8777 (Melhor: 0.8847), AUC: 0.9467, TopKAcc: 0.5942
=== Época: 36 ===

Média Train Época 36: Loss: 0.1319, P: 0.9460, R: 0.9407, F1: 0.9403, Acc: 0.9407, AUC: 0.9891, TopKAcc: 0.6345

Média Val Época 36: Loss: 0.2069, P: 0.8690, R: 0.8620, F1: 0.8608, Acc: 0.8620 (Melhor: 0.8847), AUC: 0.9330, TopKAcc: 0.5957
=== Época: 37 ===

Média Train Época 37: Loss: 0.1225, P: 0.9513, R: 0.9473, F1: 0.9470, Acc: 0.9473, AUC: 0.9911, TopKAcc: 0.6449

Média Val Época 37: Loss: 0.2072, P: 0.8763, R: 0.8693, F1: 0.8684, Acc: 0.8693 (Melhor: 0.8847), AUC: 0.9311, TopKAcc: 0.5925
=== Época: 38 ===

Média Train Época 38: Loss: 0.1240, P: 0.9541, R: 0.9500, F1: 0.9498, Acc: 0.9500, AUC: 0.9923, TopKAcc: 0.6388

Média Val Época 38: Loss: 0.2058, P: 0.8907, R: 0.8827, F1: 0.8811, Acc: 0.8827 (Melhor: 0.8847), AUC: 0.9405, TopKAcc: 0.6040
=== Época: 39 ===

Média Train Época 39: Loss: 0.1300, P: 0.9540, R: 0.9503, F1: 0.9501, Acc: 0.9503, AUC: 0.9899, TopKAcc: 0.6277

Média Val Época 39: Loss: 0.2082, P: 0.8684, R: 0.8623, F1: 0.8613, Acc: 0.8623 (Melhor: 0.8847), AUC: 0.9274, TopKAcc: 0.5948
=== Época: 40 ===

Média Train Época 40: Loss: 0.1196, P: 0.9587, R: 0.9550, F1: 0.9548, Acc: 0.9550, AUC: 0.9904, TopKAcc: 0.6499

Média Val Época 40: Loss: 0.1792, P: 0.9023, R: 0.8967, F1: 0.8961, Acc: 0.8967 (Melhor), AUC: 0.9588, TopKAcc: 0.6159
Nova melhor acurácia de validação: 0.8967. Salvando modelo...
=== Época: 41 ===

Média Train Época 41: Loss: 0.1176, P: 0.9647, R: 0.9613, F1: 0.9612, Acc: 0.9613, AUC: 0.9953, TopKAcc: 0.6348

Média Val Época 41: Loss: 0.2122, P: 0.8725, R: 0.8650, F1: 0.8636, Acc: 0.8650 (Melhor: 0.8967), AUC: 0.9344, TopKAcc: 0.5814
=== Época: 42 ===

Média Train Época 42: Loss: 0.1254, P: 0.9557, R: 0.9510, F1: 0.9506, Acc: 0.9510, AUC: 0.9911, TopKAcc: 0.6261

Média Val Época 42: Loss: 0.1957, P: 0.8969, R: 0.8897, F1: 0.8887, Acc: 0.8897 (Melhor: 0.8967), AUC: 0.9500, TopKAcc: 0.6036
=== Época: 43 ===

Média Train Época 43: Loss: 0.1105, P: 0.9656, R: 0.9633, F1: 0.9632, Acc: 0.9633, AUC: 0.9937, TopKAcc: 0.6579

Média Val Época 43: Loss: 0.2119, P: 0.8690, R: 0.8630, F1: 0.8621, Acc: 0.8630 (Melhor: 0.8967), AUC: 0.9269, TopKAcc: 0.5887
=== Época: 44 ===

Média Train Época 44: Loss: 0.1231, P: 0.9596, R: 0.9563, F1: 0.9561, Acc: 0.9563, AUC: 0.9924, TopKAcc: 0.6252

Média Val Época 44: Loss: 0.2039, P: 0.8890, R: 0.8817, F1: 0.8807, Acc: 0.8817 (Melhor: 0.8967), AUC: 0.9460, TopKAcc: 0.5803
=== Época: 45 ===

Média Train Época 45: Loss: 0.1248, P: 0.9565, R: 0.9527, F1: 0.9524, Acc: 0.9527, AUC: 0.9934, TopKAcc: 0.6204

Média Val Época 45: Loss: 0.2165, P: 0.8682, R: 0.8633, F1: 0.8625, Acc: 0.8633 (Melhor: 0.8967), AUC: 0.9295, TopKAcc: 0.5918
=== Época: 46 ===

Média Train Época 46: Loss: 0.1214, P: 0.9522, R: 0.9477, F1: 0.9473, Acc: 0.9477, AUC: 0.9926, TopKAcc: 0.6300

Média Val Época 46: Loss: 0.1926, P: 0.8890, R: 0.8827, F1: 0.8818, Acc: 0.8827 (Melhor: 0.8967), AUC: 0.9504, TopKAcc: 0.5952
=== Época: 47 ===

Média Train Época 47: Loss: 0.1181, P: 0.9612, R: 0.9580, F1: 0.9578, Acc: 0.9580, AUC: 0.9940, TopKAcc: 0.6259

Média Val Época 47: Loss: 0.1858, P: 0.9008, R: 0.8953, F1: 0.8946, Acc: 0.8953 (Melhor: 0.8967), AUC: 0.9538, TopKAcc: 0.6034
=== Época: 48 ===

Média Train Época 48: Loss: 0.1104, P: 0.9643, R: 0.9613, F1: 0.9612, Acc: 0.9613, AUC: 0.9935, TopKAcc: 0.6447

Média Val Época 48: Loss: 0.2070, P: 0.8822, R: 0.8757, F1: 0.8745, Acc: 0.8757 (Melhor: 0.8967), AUC: 0.9366, TopKAcc: 0.5937
=== Época: 49 ===

Média Train Época 49: Loss: 0.1200, P: 0.9665, R: 0.9637, F1: 0.9635, Acc: 0.9637, AUC: 0.9942, TopKAcc: 0.6281

Média Val Época 49: Loss: 0.1908, P: 0.9037, R: 0.8980, F1: 0.8971, Acc: 0.8980 (Melhor), AUC: 0.9545, TopKAcc: 0.5955
Nova melhor acurácia de validação: 0.8980. Salvando modelo...
=== Época: 50 ===

Média Train Época 50: Loss: 0.1169, P: 0.9576, R: 0.9537, F1: 0.9534, Acc: 0.9537, AUC: 0.9935, TopKAcc: 0.6236

Média Val Época 50: Loss: 0.1923, P: 0.8950, R: 0.8890, F1: 0.8880, Acc: 0.8890 (Melhor: 0.8980), AUC: 0.9497, TopKAcc: 0.6082
=== Época: 51 ===

Média Train Época 51: Loss: 0.1160, P: 0.9639, R: 0.9607, F1: 0.9605, Acc: 0.9607, AUC: 0.9957, TopKAcc: 0.6302

Média Val Época 51: Loss: 0.1990, P: 0.8819, R: 0.8773, F1: 0.8768, Acc: 0.8773 (Melhor: 0.8980), AUC: 0.9399, TopKAcc: 0.5927
=== Época: 52 ===

Média Train Época 52: Loss: 0.1179, P: 0.9643, R: 0.9610, F1: 0.9608, Acc: 0.9610, AUC: 0.9955, TopKAcc: 0.6284

Média Val Época 52: Loss: 0.2020, P: 0.8736, R: 0.8673, F1: 0.8663, Acc: 0.8673 (Melhor: 0.8980), AUC: 0.9396, TopKAcc: 0.5868
=== Época: 53 ===

Média Train Época 53: Loss: 0.1141, P: 0.9687, R: 0.9657, F1: 0.9655, Acc: 0.9657, AUC: 0.9966, TopKAcc: 0.6306

Média Val Época 53: Loss: 0.2190, P: 0.8675, R: 0.8580, F1: 0.8564, Acc: 0.8580 (Melhor: 0.8980), AUC: 0.9356, TopKAcc: 0.5830
=== Época: 54 ===

Média Train Época 54: Loss: 0.1159, P: 0.9623, R: 0.9583, F1: 0.9581, Acc: 0.9583, AUC: 0.9957, TopKAcc: 0.6302

Média Val Época 54: Loss: 0.2050, P: 0.8801, R: 0.8737, F1: 0.8727, Acc: 0.8737 (Melhor: 0.8980), AUC: 0.9415, TopKAcc: 0.5995
=== Época: 55 ===

Média Train Época 55: Loss: 0.1060, P: 0.9696, R: 0.9663, F1: 0.9661, Acc: 0.9663, AUC: 0.9966, TopKAcc: 0.6416

Média Val Época 55: Loss: 0.1918, P: 0.8996, R: 0.8937, F1: 0.8929, Acc: 0.8937 (Melhor: 0.8980), AUC: 0.9537, TopKAcc: 0.5931
=== Época: 56 ===

Média Train Época 56: Loss: 0.1098, P: 0.9649, R: 0.9620, F1: 0.9619, Acc: 0.9620, AUC: 0.9958, TopKAcc: 0.6270

Média Val Época 56: Loss: 0.2118, P: 0.8847, R: 0.8787, F1: 0.8777, Acc: 0.8787 (Melhor: 0.8980), AUC: 0.9430, TopKAcc: 0.5841
=== Época: 57 ===

Média Train Época 57: Loss: 0.1135, P: 0.9697, R: 0.9670, F1: 0.9669, Acc: 0.9670, AUC: 0.9964, TopKAcc: 0.6268

Média Val Época 57: Loss: 0.2072, P: 0.8842, R: 0.8780, F1: 0.8769, Acc: 0.8780 (Melhor: 0.8980), AUC: 0.9371, TopKAcc: 0.5952
=== Época: 58 ===

Média Train Época 58: Loss: 0.1135, P: 0.9683, R: 0.9650, F1: 0.9648, Acc: 0.9650, AUC: 0.9962, TopKAcc: 0.6155

Média Val Época 58: Loss: 0.1956, P: 0.8905, R: 0.8850, F1: 0.8843, Acc: 0.8850 (Melhor: 0.8980), AUC: 0.9501, TopKAcc: 0.5724
=== Época: 59 ===

Média Train Época 59: Loss: 0.1196, P: 0.9639, R: 0.9607, F1: 0.9605, Acc: 0.9607, AUC: 0.9939, TopKAcc: 0.6156

Média Val Época 59: Loss: 0.1974, P: 0.8997, R: 0.8950, F1: 0.8943, Acc: 0.8950 (Melhor: 0.8980), AUC: 0.9563, TopKAcc: 0.5972
=== Época: 60 ===

Média Train Época 60: Loss: 0.1110, P: 0.9667, R: 0.9630, F1: 0.9628, Acc: 0.9630, AUC: 0.9964, TopKAcc: 0.6278

Média Val Época 60: Loss: 0.1900, P: 0.8945, R: 0.8887, F1: 0.8879, Acc: 0.8887 (Melhor: 0.8980), AUC: 0.9560, TopKAcc: 0.5960
=== Época: 61 ===

Média Train Época 61: Loss: 0.1096, P: 0.9690, R: 0.9663, F1: 0.9662, Acc: 0.9663, AUC: 0.9960, TopKAcc: 0.6224

Média Val Época 61: Loss: 0.1897, P: 0.8907, R: 0.8853, F1: 0.8846, Acc: 0.8853 (Melhor: 0.8980), AUC: 0.9515, TopKAcc: 0.5968
=== Época: 62 ===

Média Train Época 62: Loss: 0.1169, P: 0.9606, R: 0.9567, F1: 0.9565, Acc: 0.9567, AUC: 0.9958, TopKAcc: 0.6149

Média Val Época 62: Loss: 0.2026, P: 0.8849, R: 0.8790, F1: 0.8782, Acc: 0.8790 (Melhor: 0.8980), AUC: 0.9394, TopKAcc: 0.5925
=== Época: 63 ===

Média Train Época 63: Loss: 0.1190, P: 0.9578, R: 0.9533, F1: 0.9530, Acc: 0.9533, AUC: 0.9937, TopKAcc: 0.6194

Média Val Época 63: Loss: 0.2054, P: 0.8859, R: 0.8800, F1: 0.8793, Acc: 0.8800 (Melhor: 0.8980), AUC: 0.9382, TopKAcc: 0.5835
=== Época: 64 ===

Média Train Época 64: Loss: 0.1120, P: 0.9684, R: 0.9653, F1: 0.9652, Acc: 0.9653, AUC: 0.9975, TopKAcc: 0.6249

Média Val Época 64: Loss: 0.2003, P: 0.8846, R: 0.8790, F1: 0.8782, Acc: 0.8790 (Melhor: 0.8980), AUC: 0.9434, TopKAcc: 0.5869
=== Época: 65 ===

Média Train Época 65: Loss: 0.1117, P: 0.9669, R: 0.9637, F1: 0.9635, Acc: 0.9637, AUC: 0.9967, TopKAcc: 0.6205

Média Val Época 65: Loss: 0.2018, P: 0.8839, R: 0.8787, F1: 0.8779, Acc: 0.8787 (Melhor: 0.8980), AUC: 0.9420, TopKAcc: 0.5966
=== Época: 66 ===

Média Train Época 66: Loss: 0.1165, P: 0.9652, R: 0.9617, F1: 0.9614, Acc: 0.9617, AUC: 0.9957, TopKAcc: 0.6149

Média Val Época 66: Loss: 0.1969, P: 0.8906, R: 0.8857, F1: 0.8850, Acc: 0.8857 (Melhor: 0.8980), AUC: 0.9420, TopKAcc: 0.5814
=== Época: 67 ===

Média Train Época 67: Loss: 0.1200, P: 0.9591, R: 0.9560, F1: 0.9559, Acc: 0.9560, AUC: 0.9950, TopKAcc: 0.6099

Média Val Época 67: Loss: 0.1965, P: 0.8904, R: 0.8857, F1: 0.8852, Acc: 0.8857 (Melhor: 0.8980), AUC: 0.9459, TopKAcc: 0.5963
=== Época: 68 ===

Média Train Época 68: Loss: 0.1136, P: 0.9655, R: 0.9627, F1: 0.9625, Acc: 0.9627, AUC: 0.9951, TopKAcc: 0.6256

Média Val Época 68: Loss: 0.2023, P: 0.8803, R: 0.8747, F1: 0.8736, Acc: 0.8747 (Melhor: 0.8980), AUC: 0.9392, TopKAcc: 0.5822
=== Época: 69 ===

Média Train Época 69: Loss: 0.1097, P: 0.9707, R: 0.9673, F1: 0.9672, Acc: 0.9673, AUC: 0.9975, TopKAcc: 0.6287

Média Val Época 69: Loss: 0.2056, P: 0.8895, R: 0.8843, F1: 0.8836, Acc: 0.8843 (Melhor: 0.8980), AUC: 0.9339, TopKAcc: 0.5948
=== Época: 70 ===
Parando cedo na época 70.
Treinamento concluído.
Carregando o melhor estado do modelo (da validação) para teste.

Testando com o melhor modelo...

Resultados Finais do Teste
Test Loss: 0.1912
Test Acc: 0.8922
Test P (macro): 0.8983
Test R (macro): 0.8922
Test F1 (macro): 0.8914
Test AUC: 0.9518
Test TopKAcc: 0.5955
Script de 5-Folds concluído
==========================================================
Job LAQDA QEvasiON Concluído!
Data de término: Mon Nov 17 12:26:44 PM -03 2025
==========================================================
